<html><head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="manifest" href="manifest.json">
        <title>ToolKit</title>
        <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMAAAADACAMAAABlApw1AAAAAXNSR0IArs4c6QAAABtQTFRFAAAAAH8AAH8AAH8AAIAAAIAAAIAAAIAAAH8AS4/2/wAAAAl0Uk5TACBggJ+/3/9Aan6BKAAAAwVJREFUeJztnO16gyAMhVe/6P1f8VY3LWhCAjYEn533XxXCOZAWFerXFwAAAAAAAAAAAAAAAAAAAABgZZhCP8xjqfzRW/KJqUT+w1stid7C7C2V43Fz/SGo9D+9VebQGPDWmGWQ9Q/eGvPcfAAUBjofANlAT/Mvxd0zCAbcgQFvYMAbGPAGBryBAW9gwBsY8AYGvPk/BsSCzZlgwBkY8AYGvIEBb2DAGxjwBga8gYFqgmp9WsTNwBpuuR7Hy8BfvOtj4GzgekAnAwEGNloYeFUcz4figEQRJQ0M/NZM9oXtu6eGJHxNdHMDM1V1SQ8u9eHNDbx3qlHhwuFjhQNjA4HWxhoon9psDUTKlAaKu8jUQOCUbcf+Nq0+uXIKDA2kGzXPjUYHl7hkWRYZGmD1E9NYsim7aEIwM5ButKajjUzxkjGwMpDIP+7Pzg9LWUcZGZhzcgb6eJ0DGwN5LdyZpJb2i2BhQMpn1lrNF8HCgJQL26nzXxeSzNONwecNZNP/3SR9bpAqM9HEYgUhYwVztoBYXZNFHzcQ77LOx5JO6/rr4wbkDhTkxd9kubnPG5il9vchIvPLfwREAftJ+s9HQap/wNYAJTKvLvkNU7RmMQ8IV5bbGfIPbKX97zETZ0L1MhOn/XgQwlzJnevpmrK6GuWl8AKT9H9qW2pyPzBSJ7I11O3Y3ZExeiZOI+tYwO6eOLlR3zNCpb+glWY39eF4MFO2pBHT50LJr+J4UEqGf1H4bM70wVYypR2kUtErmmj9bJS+manvf/un0wcDUgYVx7dfHygyoJ6+3tiv0ExxbtAGHvXRWywxrfLmqDUiTlX6RyHFYlcM/FzAbTMrn+vPqSJ9XrRdZr3wZeXwMVD0QpE8bQ1MHx+A1iv1y90NrHctdUvyDNix5Q0MeAMD3sCANzDgDQx4ozQw393A2K2BWafrynMDW7S6Os0hfcf2+abLHYXXjt8VqcwLb5EZmDX/Ax2/7lKlv98x0PX/Sn+v3A3d/S4CAAAAAAAAAAAAAAAAAAAAAP4p3zdg4GWrLZCeAAAAAElFTkSuQmCC">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
        <style>
            body {
                margin: 0px;
                padding: 0px;
            }
        </style>
        <style id="customStyle"></style>
        <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/three@0.154.0/build/three.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    </head>
    <body>
        <div id="customHTML"></div>
        <script>
            const customHTML = document.getElementById("customHTML");
            const customStyle = document.getElementById("customStyle");
            //MARK1
            let toolKit = ["//Home\n\nwindow.home = function() {\n\n    customStyle.innerHTML = `\n        body {\n            font-family: 'Courier New', monospace;\n            font-weight: bold;\n        }\n    `\n\n    const templateIcon = \"https://drive.google.com/thumbnail?id=1A1FGKgktqL5aCCfQn9bYPXAxrEZRg4Dl\"\n    const panelWidth = ((innerWidth - 60) < 500) ? 'calc(100% - 60px)' : '500px'\n    const loginButton = ('username' in window && 'password' in window) ? `<button onclick=\"\" style=\"width: 300px; height: 80px;\">Logged in as ${window.username.split('@')[0]}</button>` : `<button onclick=\"loginPage(); toggleMenu();\" style=\"width: 200px; height: 60px;\">Login</button>`\n    customHTML.innerHTML = `\n        <img style=\"position: absolute; width: 100%; height: 100%; object-fit: cover;\" src=\"https://lh3.googleusercontent.com/d/1LTVdiaax08-DvdQLlKg_ticEoKHgzyuQ\">\n        <div id=\"page\" style=\"position: absolute; width: 100%; height: 100%; z-index: 1; overflow-y: auto; scrollbar-width: none;\">\n            <div style=\"position: absolute; width: 100%; min-height: 100%; display: flex; flex-direction: ${(innerWidth > innerHeight) ? \"row\" : \"column\"}; justify-content: space-around; align-items: center;\">\n                <div style=\"width: 400px; height: 400px; font-size: 100px; margin: 20px; display: flex; justify-content: center; align-items: center; font-weight: bolder; color: rgba(255,255,255,0.9); text-decoration: underline; text-decoration-color: rgba(255,255,255,0.9);\">Welcome</div>\n                <div style=\"background-color: white; width: 400px; height: 700px; font-size: 32px; margin: 20px; text-align: center;\">Area for something<br><br>TBD</div>\n            </div>\n        </div>\n        <div id=\"toggleMenuButton\" style=\"position: absolute; top: 5px; right: 5px; width: 50px; height: 50px; background-color: rgba(255, 255, 255, 0.9); border: solid black 2px; border-radius: 6px; z-index: 2;\" onclick=\"toggleMenu();\">\n            <div style=\"height: 6px; margin: 10px 0 0 6px; width: 34px; background-color: black; border-radius: 4px;\"></div>\n            <div style=\"height: 6px; margin: 4px 0 0 6px; width: 34px; background-color: black; border-radius: 4px;\"></div>\n            <div style=\"height: 6px; margin: 4px 0 0 6px; width: 34px; background-color: black; border-radius: 4px;\"></div>\n        </div>\n        <div id=\"menuPanel\" style=\"position: absolute; left: -100%; top: 0px; width: ${panelWidth}; height: 100%; background-color: rgba(0, 0, 0, 0.9); transition: left 0.5s ease; z-index: 2; display: flex; flex-direction: column; gap: 20px; padding-top: 40px; overflow-y: auto; scrollbar-width: none;\">\n            <div style = \"display: flex; align-items: center; justify-content: center; height: 80px; font-size: 24px;\">\n                ${loginButton}\n            </div>\n            <hr style=\"background-color: white; height: 1px; width: calc(100% - 80px);\">\n            <div onclick=\"home();\" style = \"display: flex; align-items: center; text-align: left; height: 60px; font-size: 24px; color: white; padding-left: 40px;\"><img style=\"height: 50px; width: 50px; border: solid white 1px; border-radius: 4px; margin-right: 10px;\" src=\"${templateIcon}\"></img>Home</div>\n            <div onclick=\"toggleMenu();\" style = \"display: flex; align-items: center; text-align: left; height: 60px; font-size: 24px; color: white; padding-left: 40px;\"><img style=\"height: 50px; width: 50px; border: solid white 1px; border-radius: 4px; margin-right: 10px;\" src=\"${templateIcon}\"></img>Password Manager</div>\n            <div onclick=\"upload({'sent 1' : 'sent value 1' , 'sent 2' : 'sent value 2' , 'sent 3' : 'sent value 3'}, toggleMenu);\" style = \"display: flex; align-items: center; text-align: left; height: 60px; font-size: 24px; color: white; padding-left: 40px;\"><img style=\"height: 50px; width: 50px; border: solid white 1px; border-radius: 4px; margin-right: 10px;\" src=\"${templateIcon}\"></img>Game Engine</div>\n            <div onclick=\"toggleMenu();\" style = \"display: flex; align-items: center; text-align: left; height: 60px; font-size: 24px; color: white; padding-left: 40px;\"><img style=\"height: 50px; width: 50px; border: solid white 1px; border-radius: 4px; margin-right: 10px;\" src=\"${templateIcon}\"></img>Tasks</div>\n            <div onclick=\"toggleMenu();\" style = \"display: flex; align-items: center; text-align: left; height: 60px; font-size: 24px; color: white; padding-left: 40px;\"><img style=\"height: 50px; width: 50px; border: solid white 1px; border-radius: 4px; margin-right: 10px;\" src=\"${templateIcon}\"></img>Notes</div>\n            <div onclick=\"importToolKit();\" style = \"display: flex; align-items: center; text-align: left; height: 60px; font-size: 24px; color: white; padding-left: 40px;\"><img style=\"height: 50px; width: 50px; border: solid white 1px; border-radius: 4px; margin-right: 10px;\" src=\"${templateIcon}\"></img>Import</div>\n            <div onclick=\"exportToolKit(); toggleMenu();\" style = \"display: flex; align-items: center; text-align: left; height: 60px; font-size: 24px; color: white; padding-left: 40px;\"><img style=\"height: 50px; width: 50px; border: solid white 1px; border-radius: 4px; margin-right: 10px;\" src=\"${templateIcon}\"></img>Export</div>\n            <div onclick=\"reset(); toggleMenu();\" style = \"display: flex; align-items: center; text-align: left; height: 60px; font-size: 24px; color: white; padding-left: 40px;\"><img style=\"height: 50px; width: 50px; border: solid white 1px; border-radius: 4px; margin-right: 10px;\" src=\"${templateIcon}\"></img>Reset</div>\n            <div onclick=\"editToolKit(); toggleMenu();\" style = \"display: flex; align-items: center; text-align: left; height: 60px; font-size: 24px; color: white; padding-left: 40px;\"><img style=\"height: 50px; width: 50px; border: solid white 1px; border-radius: 4px; margin-right: 10px;\" src=\"${templateIcon}\"></img>Edit</div>\n            <div style = \"height: 60px;\"></div>\n        </div>\n    `;\n\n    window.page = document.getElementById(\"page\");\n    window.menuPanel = document.getElementById(\"menuPanel\");\n    window.toggleMenuButton = document.getElementById(\"toggleMenuButton\");\n\n    window.toggleMenu = function() {\n        menuPanel.style.left = (menuPanel.style.left == '-100%') ? '0px' : '-100%';\n    }\n}\n\n\nhome();\n\n\n\n\n\n","//Login\n\nwindow.loginPage = function() {\n    page.innerHTML += `\n\n    <div style=\"background-color: #fff; padding: 10px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.7); font-family: sans-serif; display: flex; justify-content: center; align-items: center; flex-direction: column; position: absolute; width: 300px; height: 400px; top: calc(50% - 200px); left: calc(50% - 150px);\">\n        <h2 style=\"text-align: center; margin-bottom: 20px; color: #333;\">Login</h2>\n        <form onsubmit=\"event.preventDefault(); sendLoginData();\"> \n            <div style=\"margin-bottom: 15px;\">\n                <label for=\"username\" style=\"display: block; margin-bottom: 5px; color: #555;\">Username:</label>\n                <input type=\"text\" id=\"usrArea\" name=\"username\" required style=\"width: calc(100% - 12px); padding: 8px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;\">\n            </div>\n            <div style=\"margin-bottom: 15px;\">\n                <label for=\"password\" style=\"display: block; margin-bottom: 5px; color: #555;\">Password:</label>\n                <input type=\"password\" id=\"pswArea\" name=\"password\" required style=\"width: calc(100% - 12px); padding: 8px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box;\">\n            </div>\n            <label for=\"overwriteCheckbox\">\n                <input type=\"checkbox\" id=\"overwriteCheckbox\" name=\"overwriteCheckbox\"> Overwrite Persistent\n            </label>\n            <hr style=\"width: 260px;\">\n            <button id=\"submitButton\" type=\"submit\" style=\"background-color: #007bff; color: #fff; padding: 10px 15px; border: none; border-radius: 4px; cursor: pointer; width: 100%;\">Login</button>\n        </form>\n    </div>\n    `\n}\n\n\nwindow.sendLoginData = function() {\n    window.username = document.getElementById(\"usrArea\").value;\n    window.password = document.getElementById(\"pswArea\").value;\n    document.getElementById(\"submitButton\").innerHTML = \"Connecting ...\";\n    document.getElementById(\"submitButton\").style.backgroundColor = \"#ffa81c\";\n    fetch(`https://script.google.com/macros/s/AKfycbwp81HODFc4GgmkfRTQkNypcfDKdaMigtOtim7q1kP8o_Ok6b-8GcjqCTkYStVmwBwIBg/exec`, {\n        redirect: \"follow\",\n        method: 'POST',\n        body: JSON.stringify({ username : username , password : password, type : \"getAll\" }),\n        headers: {\n            'Content-Type': \"text/plain;charset=utf-8\"\n        }\n    })\n    .then(response => response.text())\n    .then(result => {\n        const data = JSON.parse(result);\n        if (\"result\" in data) {\n            const overwrite = document.getElementById(\"overwriteCheckbox\").checked;\n            for (const key in data.result) {\n                if (!(key in persistent) || (key in persistent && overwrite)) persistent[key] = data.result[key];\n            }\n        } else {\n            alert(data.reply);\n        }\n        home();\n    });\n}\n\nwindow.upload = function(obj, callback = function() {}) {\n    if (!(\"username\" in window)) {\n        alert(\"You are not logged in\");\n        return;\n    } \n    fetch(`https://script.google.com/macros/s/AKfycbwp81HODFc4GgmkfRTQkNypcfDKdaMigtOtim7q1kP8o_Ok6b-8GcjqCTkYStVmwBwIBg/exec`, {\n        redirect: \"follow\",\n        method: 'POST',\n        body: JSON.stringify({ username : username , password : password, type : \"set\", keys : obj }),\n        headers: {\n            'Content-Type': \"text/plain;charset=utf-8\"\n        }\n    })\n    .then(response => response.text())\n    .then(result => {\n        const data = JSON.parse(result);\n        alert(data.reply);\n        callback();\n    });\n}\n\nwindow.grabFromServer = function(ary, callback = function() {}) {\n    if (!(\"username\" in window)) {\n        alert(\"You are not logged in\");\n        return;\n    } \n    fetch(`https://script.google.com/macros/s/AKfycbwp81HODFc4GgmkfRTQkNypcfDKdaMigtOtim7q1kP8o_Ok6b-8GcjqCTkYStVmwBwIBg/exec`, {\n        redirect: \"follow\",\n        method: 'POST',\n        body: JSON.stringify({ username : username , password : password, type : \"get\", keys : ary }),\n        headers: {\n            'Content-Type': \"text/plain;charset=utf-8\"\n        }\n    })\n    .then(response => response.text())\n    .then(result => {\n        const data = JSON.parse(result);\n        if (\"result\" in data) {\n            for (const key in data.result) {\n                persistent[key] = data.result[key];\n            }\n        } else {\n            alert(data.reply);\n        }\n        callback();\n    });\n}\n\n\n\n","//PW Manager\n","//Game Engine\n\n","//Tasks\n\n","//Notes\n\n","//Import\n\nwindow.importToolKit = function() {\n\n    const input = document.createElement('input');\n    input.type = 'file';\n    input.accept = '.json';\n\n    input.onchange = function(event) {\n        const file = event.target.files[0];\n        const reader = new FileReader();\n\n        reader.onload = function(e) {\n            try {\n                const data = JSON.parse(e.target.result);\n                if (Array.isArray(data)) {\n                    toolKit = data[0];\n                    persistent = data[1];        \n                    saveData();\n                    createScript();\n                    home();\n                }\n            } catch (error) {\n                console.log(error);\n            }\n        };\n        reader.onerror = function(error) {\n            console.log(error);\n        };\n        reader.readAsText(file);\n    };\n    input.click();\n}","//Export\n\nwindow.exportToolKit = function() {\n\n\n    page.innerHTML += `\n\n        <div style=\"background-color: #fff; padding: 10px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0, 0, 0, 0.7); font-family: sans-serif; display: flex; justify-content: center; align-items: center; flex-direction: column; position: absolute; width: 300px; height: 300px; top: calc(50% - 150px); left: calc(50% - 150px);\">\n            <h2 style=\"text-align: center; margin-bottom: 20px; color: #333;\">How would you like to export this ToolKit?</h2>\n            <form onsubmit=\"event.preventDefault(); exportAsHTMLAndJSON();\">\n                <label for=\"jsonCheckbox\">\n                    <input type=\"checkbox\" id=\"jsonCheckbox\" name=\"jsonCheckbox\" checked=true>  <u>JSON</u> : Can be Imported\n                </label>\n                <label for=\"htmlCheckbox\">\n                    <input type=\"checkbox\" id=\"htmlCheckbox\" name=\"htmlCheckbox\">  <u>HTML</u> : Can be run\n                </label>\n                <hr style=\"width: 260px;\">\n                <button id=\"exportButton\" type=\"submit\" style=\"background-color: #007bff; color: #fff; padding: 10px 15px; border: none; border-radius: 4px; cursor: pointer; width: 100%;\">Export</button>\n            </form>\n        </div>\n    `\n    window.jsonCheckbox = document.getElementById(\"jsonCheckbox\");\n    window.htmlCheckbox = document.getElementById(\"htmlCheckbox\");\n\n    window.exportAsHTMLAndJSON = function() {\n\n        if (jsonCheckbox.checked) {\n            const data = [toolKit, persistent];\n            const jsonStr = JSON.stringify(data, null, 2);\n            const blob = new Blob([jsonStr], {type: \"application/json\"});\n            const link = document.createElement('a');\n            link.href = URL.createObjectURL(blob);\n            link.download = \"SaveFile.json\";\n            link.click();\n            URL.revokeObjectURL(link.href);\n        }\n\n        if (htmlCheckbox.checked) {\n            document.getElementById(`ToolKitScript`).remove();\n            customHTML.innerHTML = \"\";\n            customStyle.innerHTML = \"\";\n            let htmlContent = document.documentElement.outerHTML;\n\n            const htmlStart = htmlContent.split(\"//MARK1\").shift();\n            const htmlFinish =  htmlContent.split(\"//MARK2\").pop();\n            const newHTML = htmlStart + `//MARK1\\n            let toolKit = ` + JSON.stringify(toolKit) + \";\\n            let persistent = \" +  JSON.stringify(persistent) + \";\\n            //MARK2\" + htmlFinish;\n\n            const blob = new Blob([newHTML], {type: 'text/html'});\n            const a = document.createElement('a');\n            a.href = URL.createObjectURL(blob);\n            a.download = 'ToolKit.html';\n            a.click();\n            URL.revokeObjectURL(a.href);\n        }\n\n        home();\n    }\n}\n\n\n","//Edit\n\nwindow.editToolKit = function(editingPage=0) {\n    window.page.innerHTML = '';\n    if (editingPage == toolKit.length-1) toolKit.push(`//Page ${editingPage+1}\\n`)\n    if (editingPage > 0) page.innerHTML += `<button onclick=\"toolKit[${editingPage}] = editArea.value; saveData(); editToolKit(${editingPage-1});\" style=\"position:absolute; top:10px; left:10px; height:40px; width:calc(50% - 60px); font-size: 24px; border-radius: 6px;\">${toolKit[editingPage-1].split(\"\\n\")[0].substring(2)}</button>`;\n    page.innerHTML += `\n            <textarea id=\"editArea\" style=\"position:absolute; border:solid black 2px; width:calc(100% - 20px); height:calc(100% - 70px); left:10px; top:60px; padding:5px; overflow-y:auto;\" wrap=off></textarea>\n            <button onclick=\"toolKit[${editingPage}] = editArea.value; saveData(); createScript(); home();\" style=\"position:absolute; top:10px; left:calc(50% - 40px); height:40px; width: 80px; font-size: 24px; border-radius: 6px;\">Save</button>\n            <button onclick=\"toolKit[${editingPage}] = editArea.value; saveData(); editToolKit(${editingPage+1});\" style=\"position:absolute; top:10px; right:10px; height:40px; width:calc(50% - 60px); font-size: 24px; border-radius: 6px;\">${toolKit[editingPage+1].split(\"\\n\")[0].substring(2)}</button>\n        `;\n    window.editArea = document.getElementById(\"editArea\");\n    editArea.value = toolKit[editingPage];\n    editArea.addEventListener('keydown', function(event) {\n        if (event.key === 'Tab') {\n            event.preventDefault();\n            const start = editArea.selectionStart;\n            const end = editArea.selectionEnd;\n            editArea.value = editArea.value.substring(0, start) + '    ' + editArea.value.substring(end);\n            editArea.selectionStart = editArea.selectionEnd = start + 4;\n        }\n    });\n}\n\n\n","//Page 9\n"];
            let persistent = {};
            //MARK2
            window.db;
            window.openDB = function() {
                return new Promise((resolve, reject) => {
                    const request = indexedDB.open("myDataDB", 1);
                    request.onerror = () => reject(request.error);
                    request.onsuccess = () => {
                        window.db = request.result;
                        resolve();
                    };
                    request.onupgradeneeded = (event) => {
                        window.db = event.target.result;
                        window.db.createObjectStore("data", { keyPath: "id" });
                    };
                });
            }
            window.saveData = function() {
                return window.openDB().then(() => {
                    const transaction = window.db.transaction(["data"], "readwrite");
                    const objectStore = transaction.objectStore("data");
                    const request = objectStore.put({
                        id: "allData",
                        toolKit: JSON.stringify(toolKit),
                        persistent: JSON.stringify(persistent)
                    });
                    return new Promise((resolve, reject) => {
                        request.onsuccess = () => resolve();
                        request.onerror = () => reject(request.error);
                    });
                });
            }
            window.loadData = function() {
                return window.openDB().then(() => {
                    const transaction = window.db.transaction(["data"], "readonly");
                    const objectStore = transaction.objectStore("data");
                    const request = objectStore.get("allData");
                    return new Promise((resolve, reject) => {
                        request.onsuccess = () => {
                            if (request.result) {
                                toolKit = JSON.parse(request.result.toolKit);
                                persistent = JSON.parse(request.result.persistent);
                                resolve({
                                    toolKit: true,
                                    persistent: true
                                });
                            } else {
                                resolve({ toolKit: null, persistent: null });
                            }
                        };
                        request.onerror = () => reject(request.error);
                    });
                });
            }
            window.reset = function() {
                return new Promise((resolve, reject) => {
                    const request = indexedDB.deleteDatabase("myDataDB");
                    request.onerror = () => reject(request.error);
                    request.onsuccess = () => resolve();
                });
            }        
            window.loadData().then(data => {
                if (data.toolKit === null || data.persistent === null) {
                    console.log("No data found or data not yet saved so using default.");
                    window.saveData();
                }
                createScript();
            });
            function createScript() {
                if (document.getElementById(`ToolKitScript`)) document.getElementById(`ToolKitScript`).remove();
                let funcText = "";
                for (let i=0; i<toolKit.length; i++) {
                    funcText += toolKit[i] + "\n";
                } 
                let scriptTag = document.createElement('script');
                scriptTag.innerHTML = funcText;
                scriptTag.id = `ToolKitScript`;
                document.body.appendChild(scriptTag);
            }
        </script>
</body></html>
