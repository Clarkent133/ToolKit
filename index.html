<html><head><script src="//www.google.com/jsapi"></script><script>window.parent.maeExportApis_();</script>
    
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>ToolKit</title>
        <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMAAAADACAMAAABlApw1AAAAAXNSR0IArs4c6QAAABtQTFRFAAAAAH8AAH8AAH8AAIAAAIAAAIAAAIAAAH8AS4/2/wAAAAl0Uk5TACBggJ+/3/9Aan6BKAAAAwVJREFUeJztnO16gyAMhVe/6P1f8VY3LWhCAjYEn533XxXCOZAWFerXFwAAAAAAAAAAAAAAAAAAAABgZZhCP8xjqfzRW/KJqUT+w1stid7C7C2V43Fz/SGo9D+9VebQGPDWmGWQ9Q/eGvPcfAAUBjofANlAT/Mvxd0zCAbcgQFvYMAbGPAGBryBAW9gwBsY8AYGvPk/BsSCzZlgwBkY8AYGvIEBb2DAGxjwBga8gYFqgmp9WsTNwBpuuR7Hy8BfvOtj4GzgekAnAwEGNloYeFUcz4figEQRJQ0M/NZM9oXtu6eGJHxNdHMDM1V1SQ8u9eHNDbx3qlHhwuFjhQNjA4HWxhoon9psDUTKlAaKu8jUQOCUbcf+Nq0+uXIKDA2kGzXPjUYHl7hkWRYZGmD1E9NYsim7aEIwM5ButKajjUzxkjGwMpDIP+7Pzg9LWUcZGZhzcgb6eJ0DGwN5LdyZpJb2i2BhQMpn1lrNF8HCgJQL26nzXxeSzNONwecNZNP/3SR9bpAqM9HEYgUhYwVztoBYXZNFHzcQ77LOx5JO6/rr4wbkDhTkxd9kubnPG5il9vchIvPLfwREAftJ+s9HQap/wNYAJTKvLvkNU7RmMQ8IV5bbGfIPbKX97zETZ0L1MhOn/XgQwlzJnevpmrK6GuWl8AKT9H9qW2pyPzBSJ7I11O3Y3ZExeiZOI+tYwO6eOLlR3zNCpb+glWY39eF4MFO2pBHT50LJr+J4UEqGf1H4bM70wVYypR2kUtErmmj9bJS+manvf/un0wcDUgYVx7dfHygyoJ6+3tiv0ExxbtAGHvXRWywxrfLmqDUiTlX6RyHFYlcM/FzAbTMrn+vPqSJ9XrRdZr3wZeXwMVD0QpE8bQ1MHx+A1iv1y90NrHctdUvyDNix5Q0MeAMD3sCANzDgDQx4ozQw393A2K2BWafrynMDW7S6Os0hfcf2+abLHYXXjt8VqcwLb5EZmDX/Ax2/7lKlv98x0PX/Sn+v3A3d/S4CAAAAAAAAAAAAAAAAAAAAAP4p3zdg4GWrLZCeAAAAAElFTkSuQmCC">
        

        <style>
            body {
                margin: 0px;
                padding: 0px;
            }
        </style>
        
        <style id="customStyle"></style>

        <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/three@0.154.0/build/three.min.js"></script>


  </head>
  <body>
    
    <div id="customHTML"></div>

    <script>
        const customHTML = document.getElementById("customHTML");
        const customStyle = document.getElementById("customStyle");
        const executable = typeof process !== 'undefined' && process.versions && process.versions.electron;
        let online = false;
        
        let Mark1;
        let functions = {"Export":["//Export\n\n\ncustomHTML.innerHTML += `\n    <div style=\"position: absolute; left:calc(50% - 150px); top:calc(50% - 150px); width: 300px; height: 300px; background-color: white; border: 2px solid black; text-align: center; z-index:4\">\n        <label style=\"position: absolute; left:calc(50% - 140px); top:calc(50% - 130px); width: 260px; height:140px; font-size: 22px;\">Would you like to export as a JSON file or HTML?<br>JSON files can be Imported<br>HTML files can be run completely independantly</label>\n        <button onclick=\"window.jsonExport()\" style=\"position: absolute; left: calc(50% - 50px); bottom:calc(50% - 70px); width: 100px; height:40px; font-size: 24px;\" >JSON</button>\n        <button onclick=\"window.htmlExport()\" style=\"position: absolute; left: calc(50% - 50px); bottom:calc(50% - 130px); width: 100px; height:40px; font-size: 24px;\" >HTML</button>\n    </div>\n`;\n\n\n//  -------- J S O N --------\n\n\nwindow.jsonExport = function() {\n    const data = [functions, persistent];\n    const jsonStr = JSON.stringify(data, null, 2);\n    const blob = new Blob([jsonStr], {type: \"application/json\"});\n    const link = document.createElement('a');\n    link.href = URL.createObjectURL(blob);\n    link.download = \"SaveFile.json\";\n    link.click();\n    URL.revokeObjectURL(link.href);\n    ToolKit();\n}\n\n\n\n//  -------- H T M L --------\n\nwindow.htmlExport = function() {\n\n    for (const funcName in functions) {\n        if (document.getElementById(`${funcName}Script`)) { document.getElementById(`${funcName}Script`).remove();}\n    }\n\n    if (document.getElementById(\"socketScript\")) document.getElementById(\"socketScript\").remove();\n\n    customHTML.innerHTML = \"\";\n    customStyle.innerHTML = \"\";\n\n    let htmlContent = document.documentElement.outerHTML;\n\n    const htmlStart = htmlContent.split(\"let Mark1;\")[0];\n    const htmlFinish = htmlContent.split(\"let Mark2;\").pop();\n    const newHTML = htmlStart + `let Mark1;\\n        let functions = ` + JSON.stringify(functions) + \";\\n        let persistent = \" +  JSON.stringify(persistent) + \";\\n        let Mark2;\" + htmlFinish;\n\n    const blob = new Blob([newHTML], {type: 'text/html'});\n    const a = document.createElement('a');\n    a.href = URL.createObjectURL(blob);\n    a.download = 'ToolKit.html';\n    a.click();\n    URL.revokeObjectURL(a.href);\n    ToolKit();\n\n}\n\n","//Page 2\n\n","//Test\n","//Page 4\n\n\n\n//Page 4\n\n\n\n\n//Page 5\n\n\n\n\n//Page 6\n\n\n\n\n//Page 7\n","//Page 4\n"],"Import":["//Import\n\nconst input = document.createElement('input');\ninput.type = 'file';\ninput.accept = '.json';\n\ninput.onchange = function(event) {\n    const file = event.target.files[0];\n    const reader = new FileReader();\n\n    reader.onload = function(e) {\n        try {\n            const data = JSON.parse(e.target.result);\n            if (Array.isArray(data)) {\n                functions = data[0];\n                persistent = data[1];        \n                saveData();\n                createScriptTags();\n                ToolKit();\n            }\n        } catch (error) {\n            console.log(error);\n        }\n    };\n\n    reader.onerror = function(error) {\n        console.log(error);\n    };\n\n    reader.readAsText(file);\n};\n\ninput.click();","//Page 2\n","//Page 3","//Page 4"],"ToolKit":["//CSS\n\nconst gridX = 16, gridY = 16, backgroundColour = \"#61993f\";\nconst colourPalette = [\n    \"#be4a2f\",\n    \"#d77643\",\n    \"#ead4aa\",\n    \"#e4a672\",\n    \"#b86f50\",\n    \"#733e39\",\n    \"#3e2731\",\n    \"#a22633\",\n    \"#e43b44\",\n    \"#f77622\",\n    \"#feae34\",\n    \"#fee761\",\n    \"#63c74d\",\n    \"#3e8948\",\n    \"#265c42\",\n    \"#193c3e\",\n    \"#124e89\",\n    \"#0099db\",\n    \"#2ce8f5\",\n    \"#ffffff\",\n    \"#c0cbdc\",\n    \"#8b9bb4\",\n    \"#5a6988\",\n    \"#3a4466\",\n    \"#262b44\",\n    \"#181425\",\n    \"#ff0044\",\n    \"#68386c\",\n    \"#b55088\",\n    \"#f6757a\",\n    \"#e8b796\",\n    \"#c28569\",\n    \"#000000\"\n];\n\n\n\n\n\n\n\n// colourOfCells\n\nif (!window.editFunctions) window.editFunctions = false;\nif (!(\"icons\" in persistent)) persistent[\"icons\"] = {};\nfor (funcName in functions) {\n    if (!(funcName in persistent.icons)) persistent.icons[funcName] = {};\n};\n\n\n\n\ncustomStyle.innerHTML = `\n    body {\n        background-color: ${backgroundColour};\n    }\n    #title {\n        position: absolute;\n        display: flex;\n        top: 10px;\n        left: 10px;\n        width: calc(100% - 24px);\n        height: 46px;\n        align-items: center;\n        justify-content: center;\n        font-weight: bold;\n        font-size: 32px;\n        border: 2px solid black;\n        border-radius: 4px;\n    }\n\n    #iconContainer {\n        position: absolute;\n        display: grid;\n        grid-gap: 10px;\n        grid-template-columns: repeat(auto-fill, 140px);\n        justify-content: space-around;\n        left: 0px;\n        top: 60px;\n        width: calc(100% - 20px);\n        height: calc(100% - 80px);\n        padding: 10px;\n        overflow-y: auto;\n    }\n\n    #iconContainer::-webkit-scrollbar {\n        display: none;\n    }\n\n    .icon {\n        text-align: center;\n        border-radius: 8px;\n        height: 180px;\n        width: 140px;\n    }\n\n    .iconImage {\n        width: 136px;\n        height: 136px;\n        border: 2px solid black;\n        border-radius: 8px;\n        image-rendering: pixelated;\n    }\n\n    .editing {\n        width: 128px;\n        height: 128px;\n        border: 6px solid orange;\n    }\n\n    .icon p {\n        display: flex;\n        width: 100%;\n        height: 40px;\n        margin: 0px;\n        padding: 0px;\n        align-items: center;\n        justify-content: center;\n        font-weight: bold;\n    }\n`;\n\n\n\n\n\n\n\n\n","//ToolKit\n\n\n\n\nif (executable) {\n    const { ipcRenderer } = require('electron')\n    window.ipcRenderer = ipcRenderer;\n};\n\nwindow.newWindow = function(funcName) {\n    if (executable) {\n        ipcRenderer.send('open-window', {\n            script: funcName\n        });\n    } else {\n        window[funcName]();\n    }\n}\n\n\n\nlet loginInfo = \"\";\nif (online) {\n    if (online.username != \"\") loginInfo = ` (Logged in as ${online.username})`\n}\n\nwindow.iconFromObject = function(obj) {\n    const tempCanvas = document.createElement(\"canvas\");\n    tempCanvas.width = gridX;\n    tempCanvas.height = gridY;\n    const tempCtx = tempCanvas.getContext('2d');\n    tempCtx.clearRect(0, 0, gridX, gridY);\n    for (const key in obj) {\n        const [x, y] = key.split('x').map(Number);\n        tempCtx.fillStyle = colourPalette[obj[key]];\n        tempCtx.fillRect(x, y, 1, 1);\n    }\n    return tempCanvas.toDataURL();\n}\n\ncustomHTML.innerHTML = `<span id=\"title\">ToolKit${loginInfo}</span><div id=\"iconContainer\"></div>`;\nconst iconContainer = document.getElementById(\"iconContainer\");\nfor (let i=0; i<Object.keys(functions).length; i++) {\n    const funcName = Object.keys(functions)[i];\n    let imageSource = iconFromObject(persistent.icons[funcName]);\n    if (editFunctions) {\n        iconContainer.innerHTML += `<div class=\"icon\" onclick=\"editFunction('${funcName}')\"><img class=\"iconImage editing\" src=\"${imageSource}\"></img><p>${funcName}</p></div>`;\n    } else {\n        if (funcName != \"ToolKit\") iconContainer.innerHTML += `<div class=\"icon\" onclick=\"newWindow('${funcName}')\"><img class=\"iconImage\" src=\"${imageSource}\"></img><p>${funcName}</p></div>`;\n    }\n}\n\nconst editText = (editFunctions) ? \"Save\" : \"Edit\"\n\nconst editImage = iconFromObject({\"12x0\":32,\"11x0\":32,\"10x0\":32,\"15x3\":32,\"15x4\":32,\"15x5\":32,\"12x1\":32,\"14x3\":32,\"11x2\":32,\"11x3\":32,\"12x4\":32,\"13x4\":32,\"14x6\":32,\"13x7\":32,\"12x7\":32,\"11x7\":32,\"9x1\":32,\"8x2\":32,\"8x3\":32,\"8x4\":32,\"8x5\":32,\"9x6\":32,\"10x7\":32,\"7x5\":32,\"6x6\":32,\"5x7\":32,\"10x8\":32,\"9x9\":32,\"8x10\":32,\"7x11\":32,\"6x12\":32,\"5x13\":32,\"4x8\":32,\"3x9\":32,\"2x10\":32,\"1x11\":32,\"0x12\":32,\"0x13\":32,\"0x14\":32,\"1x15\":32,\"2x15\":32,\"3x15\":32,\"4x14\":32,\"2x13\":32,\"3x12\":21,\"2x12\":21,\"1x12\":22,\"1x13\":22,\"1x14\":22,\"2x14\":22,\"3x14\":22,\"3x13\":21,\"2x11\":22,\"3x11\":20,\"4x11\":21,\"4x10\":20,\"5x10\":21,\"6x10\":21,\"6x9\":21,\"7x9\":21,\"7x8\":21,\"8x8\":21,\"8x7\":21,\"8x6\":21,\"7x6\":22,\"7x7\":20,\"6x7\":22,\"6x8\":20,\"5x8\":22,\"5x9\":20,\"4x9\":22,\"3x10\":22,\"4x13\":22,\"4x12\":21,\"5x12\":22,\"5x11\":21,\"6x11\":22,\"7x10\":22,\"8x9\":22,\"9x8\":22,\"9x7\":21,\"11x1\":20,\"10x1\":20,\"10x2\":21,\"10x3\":21,\"10x4\":21,\"10x5\":21,\"9x5\":22,\"9x4\":20,\"9x3\":20,\"9x2\":20,\"11x4\":21,\"11x5\":21,\"12x5\":21,\"13x5\":21,\"14x5\":21,\"14x4\":21,\"13x6\":21,\"12x6\":21,\"11x6\":21,\"10x6\":22});\n\n\nif (editFunctions) {\n    iconContainer.innerHTML += `<div class=\"icon\" onclick=\"window.createFunction();\"><img class=\"iconImage\" src=\"${editImage}\"></img><p>Create Function</p></div>`;\n    iconContainer.innerHTML += `<div class=\"icon\" onclick=\"window.removeFunction();\"><img class=\"iconImage\" src=\"${editImage}\"></img><p>Remove Function</p></div>`;\n}\n\niconContainer.innerHTML += `<div class=\"icon\" onclick=\"window.editFunctions = !window.editFunctions; ToolKit();\"><img class=\"iconImage\" src=\"${editImage}\"></img><p>${editText}</p></div>`;\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","//Editing\n\n\n\n\nwindow.editFunction = function(funcName, editingPage=0) {\n    if (funcName in functions) {\n        if (editingPage == functions[funcName].length-1) functions[funcName].push(`//Page ${editingPage+1}\\n`)\n\n        customHTML.innerHTML = `<textarea id=\"editArea\" style=\"position:absolute; border:solid black 2px; width:calc(100% - 34px); height:calc(100% - 84px); left:10px; top:60px; padding:5px; overflow-y:auto;\" wrap=off></textarea>`;\n        \n        if (editingPage != 0) {\n            const prevPageTxt = functions[funcName][editingPage-1].split(\"\\n\")[0].substring(2);\n            const nextPageTxt = functions[funcName][editingPage+1].split(\"\\n\")[0].substring(2);  \n            customHTML.innerHTML += `\n                <button onclick=\"functions['${funcName}'][${editingPage}] = editArea.value; saveData(); editFunction('${funcName}', ${editingPage-1});\" style=\"position:absolute; top:10px; left:10px; height:40px; width:calc(50% - 105px); font-size: 24px; border-radius: 6px;\">${prevPageTxt}</button>\n                <button onclick=\"changeIcon('${funcName}')\" style=\"position:absolute; top:10px; left:calc(50% - 85px); height:40px; width: 80px; font-size: 24px; border-radius: 6px;\">Icon</button>\n                <button onclick=\"functions['${funcName}'][${editingPage}] = editArea.value; saveData(); createScriptTags(); ToolKit();\" style=\"position:absolute; top:10px; right:calc(50% - 85px); height:40px; width: 80px; font-size: 24px; border-radius: 6px;\">Save</button>\n                <button onclick=\"functions['${funcName}'][${editingPage}] = editArea.value; saveData(); editFunction('${funcName}', ${editingPage+1});\" style=\"position:absolute; top:10px; right:10px; height:40px; width:calc(50% - 105px); font-size: 24px; border-radius: 6px;\">${nextPageTxt}</button>\n            `;\n        } else {\n            const nextPageTxt = functions[funcName][editingPage+1].split(\"\\n\")[0].substring(2);\n            customHTML.innerHTML += `\n                <button onclick=\"changeIcon('${funcName}')\" style=\"position:absolute; top:10px; left:calc(50% - 85px); height:40px; width: 80px; font-size: 24px; border-radius: 6px;\">Icon</button>\n                <button onclick=\"functions['${funcName}'][${editingPage}] = editArea.value; saveData(); createScriptTags(); ToolKit();\" style=\"position:absolute; top:10px; right:calc(50% - 85px); height:40px; width: 80px; font-size: 24px; border-radius: 6px;\">Save</button>\n                <button onclick=\"functions['${funcName}'][${editingPage}] = editArea.value; saveData(); editFunction('${funcName}', ${editingPage+1});\" style=\"position:absolute; top:10px; right:10px; height:40px; width:calc(50% - 105px); font-size: 24px; border-radius: 6px;\">${nextPageTxt}</button>\n            `;\n        }\n        const editArea = document.getElementById(\"editArea\");\n        editArea.value = functions[funcName][editingPage];\n        editArea.addEventListener('keydown', function(event) {\n            if (event.key === 'Tab') {\n                event.preventDefault(); // Prevent default tab behaviour\n\n                const start = editArea.selectionStart;\n                const end = editArea.selectionEnd;\n\n                // Insert 4 spaces at the current cursor position\n                editArea.value = editArea.value.substring(0, start) + '    ' + editArea.value.substring(end);\n\n                // Move the cursor to the end of the inserted spaces\n                editArea.selectionStart = editArea.selectionEnd = start + 4;\n            }\n        });\n    }\n}\n\n\nwindow.createFunction = function() {\n    customHTML.innerHTML += `\n        <div style=\"position: absolute; left:calc(50% - 150px); top:calc(50% - 100px); width:300px; height: 200px; background-color: white; border: 2px solid black; text-align: center; z-index:4\">\n            <label style=\"position: absolute; left:calc(50% - 130px); top:calc(50% - 80px); width:260px; height:40px; font-size: 24px;\">Please enter the name of the new function</label>\n            <input id=\"functionNameInput\" type=\"text\" style=\"position: absolute; left:calc(50% - 130px); top:calc(50% - 14px); width:260px; height:40px; font-size: 18px;\" placeholder=\"Enter function name\">\n            <button onclick=\"const functionName = document.getElementById('functionNameInput').value; functions[functionName] = ['//Page 0']; createScriptTags(); saveData(); ToolKit();\" style=\"position: absolute; left: calc(50% - 40px); bottom:calc(50% - 80px); width: 80px; height:40px; font-size: 24px;\">Enter</button>\n        </div>\n    `;\n}\n\n\nwindow.removeFunction = function() {\n    customHTML.innerHTML += `\n        <div style=\"position: absolute; left:calc(50% - 150px); top:calc(50% - 100px); width:300px; height: 200px; background-color: white; border: 2px solid black; text-align: center; z-index:4\">\n            <label style=\"position: absolute; left:calc(50% - 130px); top:calc(50% - 80px); width:260px; height:40px; font-size: 24px;\">Please enter the name of the function to remove</label>\n            <input id=\"functionNameInput\" type=\"text\" style=\"position: absolute; left:calc(50% - 130px); top:calc(50% - 14px); width:260px; height:40px; font-size: 18px;\" placeholder=\"Enter function name\">\n            <button onclick=\"const functionName = document.getElementById('functionNameInput').value; if (functionName in functions) {delete functions[functionName]; delete persistent.icons[functionName]; document.getElementById(functionName + 'Script').remove(); saveData();};  ToolKit();\" style=\"position: absolute; left: calc(50% - 40px); bottom:calc(50% - 80px); width: 80px; height:40px; font-size: 24px;\">Enter</button>\n        </div>\n    `;\n}\n\n\n\n","//Icon\n\n\nwindow.changeIcon = function (funcName) {\n    let cellX = 16, cellY = 16; // Grid size\n    let icon = persistent.icons[funcName] || {};\n    let selectedColorIndex = 0;\n\n    function updateLayout() {\n        let isVertical = window.innerHeight > window.innerWidth;\n        let gridSize = Math.min(window.innerWidth * 0.8, window.innerHeight * 0.8);\n        let cellSize = Math.floor(gridSize / Math.max(cellX, cellY));  // Ensure integer cell size\n        let paletteColumns = Math.ceil(Math.sqrt(colourPalette.length));\n\n        customStyle.innerHTML = `\n            .editorContainer {\n                display: flex;\n                flex-direction: ${isVertical ? \"column\" : \"row\"};\n                justify-content: center;\n                align-items: center;\n                height: 100vh;\n                gap: 20px;\n            }\n            .gridContainer {\n                display: grid;\n                grid-template-columns: repeat(${cellX}, ${cellSize}px);\n                grid-template-rows: repeat(${cellY}, ${cellSize}px);\n                width: calc(${(cellSize * cellX) + 4}px);\n                height: calc(${(cellSize * cellY) + 4}px);\n                border: 2px solid black;\n                box-sizing: border-box;\n                margin: 0;\n                padding: 0;\n                gap: 0;\n            }\n            .gridContainer div {\n                background: #fff;\n                transition: background 0.2s;\n                border: 1px solid #ccc;\n                width: ${cellSize}px;\n                height: ${cellSize}px;\n                box-sizing: border-box;\n            }\n            .paletteContainer {\n                display: grid;\n                grid-template-columns: repeat(${paletteColumns}, 1fr);\n                gap: 5px;\n            }\n            .paletteContainer div {\n                width: 6vh;\n                height: 6vh;\n                border: 1px solid black;\n                cursor: pointer;\n            }\n            .selected {\n                outline: 3px solid red;\n            }\n            .controlContainer {\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n                gap: 10px;\n            }\n            .controlContainer button {\n                width: 120px;\n                height: 40px;\n            }\n        `;\n\n        // Correct element order for layout\n        editorContainer.innerHTML = \"\";\n        if (isVertical) {\n            editorContainer.append(grid, controlContainer);\n        } else {\n            editorContainer.append(controlContainer, grid);\n        }\n    }\n\n    // Create main containers\n    customHTML.innerHTML = \"\";\n    const editorContainer = document.createElement(\"div\"),\n          controlContainer = document.createElement(\"div\"),\n          grid = document.createElement(\"div\"),\n          palette = document.createElement(\"div\");\n\n    editorContainer.classList.add(\"editorContainer\");\n    controlContainer.classList.add(\"controlContainer\");\n    grid.classList.add(\"gridContainer\");\n    palette.classList.add(\"paletteContainer\");\n\n    customHTML.appendChild(editorContainer);\n\n    // Create grid\n    let isMouseDown = false;\n    for (let j = 0; j < cellY; j++) {\n        for (let i = 0; i < cellX; i++) {\n            const cell = document.createElement(\"div\");\n            cell.id = `${i}x${j}`;\n            cell.style.backgroundColor = icon[cell.id] !== undefined ? colourPalette[icon[cell.id]] : \"transparent\";\n\n            const toggleCell = () => {\n                if (selectedColorIndex === -1) {\n                    delete icon[cell.id];\n                    cell.style.backgroundColor = \"transparent\";\n                } else {\n                    icon[cell.id] = selectedColorIndex;\n                    cell.style.backgroundColor = colourPalette[selectedColorIndex];\n                }\n            };\n\n            cell.addEventListener(\"mousedown\", (e) => { e.preventDefault(); isMouseDown = true; toggleCell(); });\n            cell.addEventListener(\"mouseover\", () => isMouseDown && toggleCell());\n            cell.addEventListener(\"touchstart\", (e) => { e.preventDefault(); toggleCell(); });\n            cell.addEventListener(\"touchmove\", (e) => {\n                e.preventDefault();\n                const touchedCell = document.elementFromPoint(e.touches[0].clientX, e.touches[0].clientY);\n                if (touchedCell && touchedCell !== cell) toggleCell();\n            });\n\n            grid.appendChild(cell);\n        }\n    }\n\n    window.addEventListener(\"mouseup\", () => isMouseDown = false);\n\n    // Create palette dynamically\n    colourPalette.forEach((color, i) => {\n        const colorOption = document.createElement(\"div\");\n        colorOption.style.backgroundColor = color;\n        colorOption.dataset.colorIndex = i;\n        if (i === selectedColorIndex) colorOption.classList.add(\"selected\");\n\n        colorOption.addEventListener(\"click\", () => {\n            document.querySelectorAll(\".paletteContainer div, .controlContainer button\").forEach(div => div.classList.remove(\"selected\"));\n            colorOption.classList.add(\"selected\");\n            selectedColorIndex = i;\n        });\n\n        palette.appendChild(colorOption);\n    });\n\n    // Create buttons\n    const eraseButton = document.createElement(\"button\"),\n          saveButton = document.createElement(\"button\");\n\n    eraseButton.innerHTML = \"Erase\";\n    eraseButton.onclick = () => {\n        document.querySelectorAll(\".paletteContainer div\").forEach(div => div.classList.remove(\"selected\"));\n        selectedColorIndex = -1;\n        eraseButton.classList.add(\"selected\");\n    };\n\n    saveButton.innerHTML = \"Save\";\n    saveButton.onclick = () => {\n        persistent.icons[funcName] = icon;\n        saveData();\n        ToolKit();\n    };\n\n    controlContainer.append(palette, eraseButton, saveButton);\n\n    // Append elements in the correct order based on screen size\n    updateLayout();\n    window.addEventListener(\"resize\", updateLayout);\n};\n\n\n\n\n/*\n\nwindow.changeIcon = function (funcName) {\n    const cellSize = 30;\n    let icon = persistent.icons[funcName];\n\n    customStyle.innerHTML = `\n        .gridContainer {\n            position: absolute;\n            display: grid;\n            grid-template-columns: repeat(${gridX}, ${cellSize}px);\n            width: ${cellSize * gridX}px;\n            height: ${cellSize * gridY}px;\n            border: 2px solid black;\n        }\n        .gridContainer div {\n            background: #fff;\n            transition: background 0.2s;\n            box-sizing: border-box;\n            border: 1px solid #ccc;\n        }\n        button {\n            position: absolute;\n            top: ${(cellSize * gridY) + 10}px;\n            left: 10px;\n            width: 100px;\n            height: 40px;\n        }\n    `;\n\n    customHTML.innerHTML = \"\";\n\n    const grid = document.createElement(\"div\");\n    grid.classList.add(\"gridContainer\");\n    customHTML.appendChild(grid);\n\n    let isMouseDown = false;\n    const toggleCell = (cell) => {\n        if (cell.id in icon) {\n            delete icon[cell.id];\n        } else {\n            icon[cell.id] = 0;\n        }\n        cell.style.backgroundColor = (cell.id in icon) ? colourPalette[icon[cell.id]] : \"transparent\";\n    }\n\n    for (let j = 0; j < gridY; j++) {\n        for (let i = 0; i < gridX; i++) {\n            const cell = document.createElement(\"div\");\n            cell.id = `${i}x${j}`\n            if (cell.id in icon) cell.style.backgroundColor = colourPalette[icon[cell.id]];\n            grid.appendChild(cell);\n            \n            cell.addEventListener(\"mousedown\", (e) => { e.preventDefault(); isMouseDown = true; toggleCell(cell); });\n            cell.addEventListener(\"mouseover\", () => { if (isMouseDown) toggleCell(cell); });\n            cell.addEventListener(\"click\", (e) => e.preventDefault()); // Prevent click from toggling twice\n            \n            cell.addEventListener(\"touchstart\", (e) => { e.preventDefault(); toggleCell(cell); });\n            cell.addEventListener(\"touchmove\", (e) => {\n                e.preventDefault();\n                const touchedCell = document.elementFromPoint(e.touches[0].clientX, e.touches[0].clientY);\n                if (touchedCell && touchedCell !== cell) toggleCell(touchedCell);\n            });\n        }\n    }\n\n    window.addEventListener(\"mouseup\", () => isMouseDown = false);\n\n    const saveButton = document.createElement(\"button\");\n    saveButton.innerHTML = \"Save\";\n    saveButton.onclick = () => {\n        persistent.icons[funcName] = icon;\n        saveData();\n        ToolKit();\n    }\n    customHTML.appendChild(saveButton)\n    \n};\n\n*/\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","//Extra\n\nwindow.loadDialog = function(dialog) {\n    let tracker = 0;\n    let btnArray = [];\n    function progress() {\n        let looping = true;\n        while (looping) {\n            const type = dialog[tracker].split(\":\")[0];\n            const txt = dialog[tracker].split(\":\")[1];\n            if (type == \"B\") {\n                const btnBroken = txt.split(\"#\");\n                const title = btnBroken.shift();\n                const js = btnBroken.join(\"#\");\n                btnArray.push({title:title , js:js})\n            } else if (type == \"T\") {\n                if (btnArray.length == 0) btnArray = [{title:\"Continue\" , js:\"progress()\"}];\n                showText(txt, btnArray);\n                btnArray = [];\n                looping = false;\n            } else if (type == \"D\") {\n                if (btnArray.length == 0) btnArray = [{title:\"Continue\" , js:\"progress()\"}];\n                showDecision(txt, btnArray);\n                btnArray = [];\n                looping = false;\n            }\n            tracker++;\n        }\n    }\n\n    function showText(txt, buttonArray) {\n        let buttonText = '';\n        buttonArray.forEach((btnObj, index) => {\n            buttonText += `<button style=\"min-width: 140px; width: auto; height: 40px;\" onclick=\"${btnObj.js}\">${btnObj.title}</button>`;\n        });\n\n        const isOverflowing = buttonArray.length > Math.floor((innerWidth-20)/160);\n\n        customStyle.innerHTML = `\n            body {\n                background-color: white;\n            }\n            #selectionArea {\n                position: absolute;\n                display: flex;\n                justify-content: ${isOverflowing ? 'flex-start' : 'center'};\n                gap: 10px;\n                overflow-x: auto;\n                overflow-y: hidden;\n                width: calc(100% - 20px);\n                height: 40px;\n                bottom: 10px;\n                left: 10px;\n                white-space: nowrap;\n                scrollbar-width: none;\n                scroll-behavior: smooth;\n            }\n\n            #selectionArea::-webkit-scrollbar {\n                display: none;\n            }\n        `;\n\n        customHTML.innerHTML = `\n            <div style=\"position: absolute; width: calc(100% - 40px); height: calc(100% - 86px); left: 10px; top: 10px; border: 2px solid black; border-radius: 4px; padding: 8px; overflow-y: auto;\">\n                ${txt}\n            </div>\n            <div id=\"selectionArea\">${buttonText}</div>\n        `;\n\n        if (isOverflowing) {\n            document.getElementById('selectionArea').scrollLeft = 0;\n        }\n    }\n\n    function showDecision(txt, buttonArray) {\n        let buttonText = '';\n        buttonArray.forEach((btnObj, index) => {\n            buttonText += `<button style=\"min-width: 160px; width: 100%; min-height: 80px; margin: 5px 0; font-size: 18px; padding: 10px; text-align: center; white-space: normal; word-wrap: break-word;\" onclick=\"${btnObj.js}\">${btnObj.title}</button>`;\n        });\n\n        customStyle.innerHTML = `\n            body {\n                background-color: white;\n            }\n            #dialogContainer {\n                position: absolute;\n                top: 10px;\n                left: 10px;\n                width: calc(100% - 44px);\n                height: calc(100% - 44px);\n                padding: 10px;\n                display: flex;\n                flex-direction: column;\n                justify-content: flex-start;\n                border: 2px solid black;\n                border-radius: 4px;\n                background-color: #f9f9f9;\n                overflow: hidden; /* Hide scrollbars on the main container */\n            }\n\n            #txtTitle {\n                width: calc(100% - 20px); /* Ensure the title area fits within the dialog width */\n                min-height: 60px;\n                background-color: #e0e0e0;\n                display: flex;\n                justify-content: center;\n                align-items: center;\n                font-size: 20px;\n                font-weight: bold;\n                text-align: center;\n                border: 2px solid #ccc;\n                border-radius: 4px;\n                margin-bottom: 10px;\n                padding: 10px;\n                word-wrap: break-word;\n            }\n\n            #selectionArea {\n                width: 100%;\n                flex-grow: 1; /* Allow the button area to take available space */\n                display: flex;\n                flex-direction: column;\n                justify-content: flex-start;\n                align-items: center;\n                padding: 10px 0;\n                gap: 10px;\n                overflow-y: auto; /* Enable vertical scrolling */\n                scrollbar-width: none; /* Hide scrollbar in modern browsers */\n            }\n\n            #selectionArea::-webkit-scrollbar {\n                display: none; /* Hide scrollbar in Webkit browsers */\n            }\n        `;\n\n        customHTML.innerHTML = `\n            <div id=\"dialogContainer\">\n                <div id=\"txtTitle\">${txt}</div>\n                <div id=\"selectionArea\">${buttonText}</div>\n            </div>\n        `;\n    }\n\n\n\n\n\n\n    progress();\n}\n\n\n\n\n","//Page 5\n","//Page 6\n"],"Help":["//Help\n\n\n\nconst helpText = [\n    'B:Return#ToolKit()',\n    `T:\n    <center>\n        <u><h1>Help</h1></u>\n    </center>\n    <p>Welcome to the ToolKit. This application was created for a single purpose, to make small applications using Web Development technology simple and convenient.</p>\n    <br>\n    <br>\n    <p>The long story short of how this works, on the home page you had several app looking icons, one of which being this help page. Well each of these is a function coded with JS (JavaScript).</p>\n    <p>These functions use that JS to generate custom page content, and is also capable of some pretty powerful calculations and interactions.</p>\n    <p>Whilst this help page isn't going into detail on JS and how to code in it, I recommend this free online website to get started : <a href=\"https://www.jschallenger.com/\">www.jschallenger.com</a></p>\n    <br>\n    <p>Clicking any of the apps on the homepage will run it's respective JS code, to edit their code, there is a blank app at the end named \"Edit\", after clicking this the apps will gain an orange border to indicate that they are in edit mode.</p>\n    <p>Clicking on an app whilst in edit mode brings up a text editor to enter the JS to run. The buttons in the top-left and top-rigth are for cycling through pages, In the end they are all run as 1 page so this is purely for organising the code into seperate chunks, the title of the buttons is the first lines comment.</p>\n    <p>Here you can also select \"Icon\" to change the icon of the app. Currently it is only a 16x16 image of a single colour, but i'm working on upgrading this feature soon to support a full colour palette and variable size options.<p>\n    <p>Here are a list of all the included functions:</p>\n    <ol>\n        <li><u>ToolKit</u> : This function is what creates the intial page that you view and runs automatically on launch, this means that if you want to change the design of this app in any way, that's the function to edit.</li>\n        <br>\n        <li><u>Import</u> : This function allows you to select a local JSON file created from the Export function and load it.</li>\n        <br>\n        <li><u>Export</u> : This function allows you to export the ToolKit and all of your modifications as an HTML file for complete offline use, or to just export the changes into a JSON file.</li>\n        <br>\n        <li><u>Files</u> : This function allows you to upload local files from your device to store (still locally) within the ToolKit, making the file data available as base 64 strings via the variable \"persistent.files[fileName]\"</li>\n        <br>\n        <li><u>Login</u> : This function allows you to login to an account on my server if you have one which allows you to access files linked to the account on the server via the Files function.</li>\n        <br>\n        <li><u>Multiplayer</u> : This function allows you to create a lobby for other players to join, if you are all connected via the web version of ToolKit, you can use a code generated by the server for quick joining, otherwise it can guide you through setting up direct Peer 2 Peer connections.</li>\n        <br>\n        <li><u>Reset</u> : This function removes all changes that you have made permentantly and restores you back to the default ToolKit experience after a refresh.</li>\n    </ol>\n    `\n];\n\nloadDialog(helpText)\n\n","//Page 1\n"],"Reset":["//Page 0\n\nreset();","//Page 1\n"],"Fullscreen":["//Page 0\n\ndocument.documentElement.requestFullscreen();","//Page 1\n"],"GameEngine":["//Game\n\n\ncustomStyle.innerHTML = \"body {background-color: white;}\";\ncustomHTML.innerHTML = \"\";\n\nconst game = {\n\n    config : {\n        mapSize : 16,\n        levelSize : 16\n    },\n\n    spriteSheetString : \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAAAgCAYAAADaInAlAAAAAXNSR0IArs4c6QAAAItJREFUeJzt18ENgCAMBVA1ruEEjuOcjOMEDqInE2NEvNq+dyP0VviFrgPy6msb07zs1/W2lmotwdybf18Tx9Aq0PzYmgdA9Cd13nwJENvj7fYATG6al/16CKRAXK9vAI2Pb6xtiP0cmr8AYqsmgPjP4TUBtrX0RkFsRkByn38BRgIAAAAAAAAAwD8cQ6Uk6ZS0IU8AAAAASUVORK5CYII=\",\n\n    sprites : [], // <---- To be populated with new Images of the broken sprite sheet.\n\n    startingLevel : \"LevelEditor\",\n\n    currentLevel : \"\",\n\n    keys : {mouse:{x:0 , y:0 , isDown:false , clickUsed:false}},\n\n    init: (levelName) => {\n        //Prepare for FPS\n        window.lastFrameTime = performance.now();\n        window.frameCount = 0;\n        window.lastFpsUpdate = performance.now();\n\n        //Canvas Setup\n        let canvasStyle = (innerHeight > innerWidth) ? ` margin-top:;` : `margin-left`;\n        document.body.innerHTML = `<canvas id=\"canvas\" width=\"${(game.config.mapSize + 2)*game.config.mapSize}px\" height=\"${(game.config.mapSize + 2)*game.config.mapSize}px\"></canvas>`;\n        window.canvas = document.getElementById(\"canvas\");\n        window.ctx = canvas.getContext(\"2d\");\n\n        function scaleCanvas() {\n            canvas.style.width = (innerHeight > innerWidth) ? `${innerWidth}px` : `${innerHeight}px`;\n            canvas.style.height= (innerHeight > innerWidth) ? `${innerWidth}px` : `${innerHeight}px`;\n            canvas.style.marginLeft = (innerHeight > innerWidth) ? `0px` : `${(innerWidth-innerHeight)/2}px`;\n            canvas.style.marginTop = (innerHeight > innerWidth) ? `${(innerHeight-innerWidth)/2}px` : `0px`;\n            canvas.style.imageRendering = \"pixelated\";\n        }\n        scaleCanvas();\n        window.addEventListener('resize', scaleCanvas);\n\n\n\n\n\n\n\n        //Engine\n        window.create = function(obj) {\n            game.levels[game.currentLevel].objectTracker += 1;\n            const objID = `object_${game.levels[game.currentLevel].objectTracker}`;\n            game.levels[game.currentLevel].objects[objID] = obj;\n            return objID;\n        };\n\n        window.destroy = function(objID) {\n            if (objID in game.levels[game.currentLevel].objects) delete game.levels[game.currentLevel].objects[objID];\n        };\n\n        window.clicked = function(obj) {\n            if (typeof obj === \"string\") {\n                if (!(obj in game.keys)) return;\n                if (game.keys[obj].isDown && !game.keys[obj].clickUsed) {\n                    game.keys[obj].clickUsed = true;\n                    return true;\n                }\n            } else if (game.keys.mouse.x >= obj.x && game.keys.mouse.y >= obj.y && game.keys.mouse.x < obj.x+game.config.mapSize && game.keys.mouse.y < obj.y+game.config.mapSize) {\n                if (!game.keys.mouse.clickUsed && game.keys.mouse.isDown) {\n                    game.keys.mouse.clickUsed = true;\n                    return true;\n                }\n            }\n            return false;\n        };\n\n        window.held= function(obj) {\n            if (typeof obj === \"string\") {\n                if (!(obj in game.keys)) return;\n                return game.keys[obj].isDown;\n            } else if (game.keys.mouse.x >= obj.x && game.keys.mouse.y >= obj.y && game.keys.mouse.x < obj.x+game.config.mapSize && game.keys.mouse.y < obj.y+game.config.mapSize) {\n                return game.keys.mouse.isDown;\n            }\n            return false;\n        };\n\n        function mouseTrigger(e) {\n            const leftOffset = (innerHeight > innerWidth) ? 0 : (innerWidth-innerHeight)/2;\n            const topOffset = (innerHeight > innerWidth) ? (innerHeight-innerWidth)/2 : 0;\n            const canvasStyleSize = (innerHeight > innerWidth) ? innerWidth : innerHeight;\n            const scale = ((game.config.mapSize + 2)*game.config.mapSize) / canvasStyleSize;\n            game.keys.mouse.x = Math.floor((e.clientX-leftOffset)*scale);\n            game.keys.mouse.y = Math.floor((e.clientY-topOffset)*scale);\n        }\n        window.addEventListener('keydown', function(e) {game.keys[e.key.toLowerCase()] = {isDown:true , clickUsed:false}});\n        window.addEventListener('keyup', function(e) {game.keys[e.key.toLowerCase()] = {isDown:false , clickUsed:false}});\n        canvas.addEventListener('mousedown', (e) => {game.keys.mouse.isDown = true; mouseTrigger(e);});\n        canvas.addEventListener('mousemove', mouseTrigger);\n        canvas.addEventListener('mouseup', (e) => {\n            game.keys.mouse.isDown = false;\n            game.keys.mouse.clickUsed = false;\n        });\n\n\n        //Create Images from SpriteSheet\n        let ss = new Image();\n        ss.src = game.spriteSheetString;\n        ss.onload = () => {\n            const cols = ss.width / game.config.mapSize;\n            const rows = ss.height / game.config.mapSize;\n            const tempCanvas = document.createElement(\"canvas\");\n            const tempCtx = tempCanvas.getContext(\"2d\");\n            tempCanvas.width = game.config.mapSize;\n            tempCanvas.height = game.config.mapSize;\n            let imagesLoaded = 0\n            for (let y = 0; y < rows; y++) {\n                for (let x = 0; x < cols; x++) {\n                    tempCtx.clearRect(0, 0, tempCanvas.width, tempCanvas.height);\n                    tempCtx.drawImage(ss, x * game.config.mapSize, y * game.config.mapSize, game.config.mapSize, game.config.mapSize, 0, 0, game.config.mapSize, game.config.mapSize);\n                    let sprite = new Image();\n                    sprite.src = tempCanvas.toDataURL();\n                    sprite.onload = () => {\n                        game.sprites.push(sprite);\n                        imagesLoaded++;\n                        if (imagesLoaded == (cols*rows)) {\n                            console.log(\"Sprites loaded:\", game.sprites.length);\n                            console.log(game.sprites)\n                            game.update(); // <---- Begins Updating each frame\n                            game.runLevel(game.startingLevel);\n                        }\n                    }\n                }\n            }\n            \n        };\n\n    },\n\n\n    update: (timestamp) => {\n        requestAnimationFrame(game.update);\n        const now = performance.now();\n        window.delta = (now - lastFrameTime) / 1000; // Convert to seconds\n        lastFrameTime = now;\n        frameCount++;\n        if (now - lastFpsUpdate >= 5000) { // Every 5 seconds, update FPS\n            window.fps = frameCount / 5;\n            frameCount = 0;\n            lastFpsUpdate = now;\n            console.log(`FPS: ${fps}`);\n        }\n        \n    },\n\n\n\n    runLevel : (levelName) => {\n        game.currentLevel = levelName;\n\n        if (Object.keys(game.levels[levelName].maps).length == 0) { // <---- L E V E L   C R E A T I O N\n\n            game.levels[levelName].maps['0x0'] = game.levels[levelName].startingMap\n\n            // <---- C O D E   F O R   S P A W N I N G   S I D E   M A P S   H E R E\n\n            for (const mapPos in game.levels[levelName].maps) {\n                const mapName = game.levels[levelName].maps[mapPos];\n                for (const objPos in game.maps[mapName].foreground) {\n                    const xPos = parseInt(objPos.split(\"x\")[0]) * game.config.mapSize;\n                    const yPos = parseInt(objPos.split(\"x\")[1]) * game.config.mapSize;\n                    create(Object.assign({x:xPos , y:yPos}, game.maps[mapName].foreground[objPos]));\n                }\n            }\n\n            // <---- G E N E R A T E   L E V E L   B A C K G R O U N D   I M A G E   H E R E\n        }\n\n        game.levels[levelName].init();\n        for (const objName in game.levels[levelName].objects) {\n            game.levels[levelName].objects[objName].init(game.levels[levelName].objects[objName]);\n        }\n        // Draw level Background here !\n        function updateLevel() {\n            requestAnimationFrame(updateLevel);\n            if (game.currentLevel != levelName) return;\n            ctx.clearRect(0, 0, canvas.width, canvas.height);\n            game.levels[levelName].update();\n            for (const objName in game.levels[levelName].objects) {\n                const obj = game.levels[levelName].objects[objName];\n                obj.update(obj);\n                ctx.imageSmoothingEnabled = false;\n                ctx.drawImage(game.sprites[obj.spr], Math.floor(obj.x), Math.floor(obj.y), game.config.mapSize, game.config.mapSize);\n            }\n        }\n        updateLevel()\n    },\n\n\n\n    maps : {\n        LevelEditor : {\n            background : [], // <---- List of Sprite ID's\n            foreground : {\n                \"3x2\" : {spr:1 , anim:[1] , speed:1 , init:(obj) => {} , update:(obj) => {\n                    if (held(\"w\")) obj.y -= 50*delta; \n                    if (held(\"a\")) obj.x -= 50*delta; \n                    if (held(\"s\")) obj.y += 50*delta; \n                    if (held(\"d\")) obj.x += 50*delta;\n                }}\n            },\n            top : [],\n            left : [],\n            right : [],\n            bottom : []\n        }\n    },\n\n\n    levels : {\n        LevelEditor : {\n            startingMap : \"LevelEditor\",\n            backgroundImage : \"\",\n            init : () => {},\n            update : () => {\n                ctx.fillStyle = \"black\";\n                ctx.fillRect(0, 0, canvas.width, canvas.height);\n            },\n            objectTracker : 0,\n            maps : {},\n            objects : {}\n        }\n    }\n\n}\n\ngame.init();\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","//Page 1\n"],"CardCreator":["//CardCreator\n\n\n//---------- F O R   E D I T I N G   E X P O R T   G R I D ----------\n\n\nconst xCoord = 4;\nconst yCoord = 15;\nconst deckToDownload = \"Deck 1\";\n\n\n//---------- C A R D S ----------\n\n\nconst decks = {\n\n    \"Deck 1\" : {\n        \"Garran Stonefist\" : {\n            Durability:18,\n            SuitValue:\"AC\",\n            Footer:\"Character\",\n            Abilities:[\n                {Title:\"Play\" , Text:\"Play 1 Card from your Hand into your Field.\" , Flavour:\"\" , Cost:[\"Slow\"]},\n                {Title:\"Draw\" , Text:\"Draw the top Card from your Deck into your Hand.\" , Flavour:\"\" , Cost:[\"Slow\"]},\n                {Title:\"Untap\" , Text:\"Untap all cards in your field.\" , Flavour:\"\" , Cost:[\"Slow\"]},\n                {Title:\"Attribute\" , Text:\"Generate 2 Power Points and 1 Agility Point.\" , Flavour:\"\" , Cost:[\"Tap\"]},\n                {Title:\"\" , Text:\"\" , Flavour:\"Half-Orc Barbarian\" , Cost:[]}\n            ]\n        },\n        \"Tessa Vale\" : {\n            Durability:14,\n            SuitValue:\"AH\",\n            Footer:\"Character\",\n            Abilities:[\n                {Title:\"Play\" , Text:\"Play 1 Card from your Hand into your Field.\" , Flavour:\"\" , Cost:[\"Tap\"]},\n                {Title:\"Draw\" , Text:\"Draw the top Card from your Deck into your Hand.\" , Flavour:\"\" , Cost:[\"Slow\"]},\n                {Title:\"Untap\" , Text:\"Untap all cards in your field.\" , Flavour:\"\" , Cost:[\"Slow\"]},\n                {Title:\"Attribute\" , Text:\"Generate 2 Agility Points and 1 Wisdom Point.\" , Flavour:\"\" , Cost:[\"Tap\"]},\n                {Title:\"\" , Text:\"\" , Flavour:\"Tiefling Rogue\" , Cost:[]}\n            ]\n        },\n        \"Victor Wren\" : {\n            Durability:14,\n            SuitValue:\"AS\",\n            Footer:\"Character\",\n            Abilities:[\n                {Title:\"Play\" , Text:\"Play 1 Card from your Hand into your Field.\" , Flavour:\"\" , Cost:[\"Slow\"]},\n                {Title:\"Draw\" , Text:\"Draw the top 2 Cards from your Deck into your Hand.\" , Flavour:\"\" , Cost:[\"Slow\", \"Tap\"]},\n                {Title:\"Untap\" , Text:\"Untap all cards in your field.\" , Flavour:\"\" , Cost:[\"Slow\"]},\n                {Title:\"Attribute\" , Text:\"Generate 2 Wisdom Points and 1 Power Point.\" , Flavour:\"\" , Cost:[\"Tap\"]},\n                {Title:\"\" , Text:\"\" , Flavour:\"Human Wizard\" , Cost:[]}\n            ]\n        },\n        \"Rosie Goodwin\" : {\n            Durability:16,\n            SuitValue:\"AD\",\n            Footer:\"Character\",\n            Abilities:[\n                {Title:\"Play\" , Text:\"Play 1 Card from your Hand into your Field.\" , Flavour:\"\" , Cost:[\"Slow\"]},\n                {Title:\"Draw\" , Text:\"Draw the top Card from your Deck into your Hand.\" , Flavour:\"\" , Cost:[\"Slow\"]},\n                {Title:\"Untap\" , Text:\"Untap all cards in your field.\" , Flavour:\"\" , Cost:[\"Slow\"]},\n                {Title:\"Attribute\" , Text:\"Generate 1 Power Point, 1 Agility Point and 1 Wisdom Point.\" , Flavour:\"\" , Cost:[\"Tap\"]},\n                {Title:\"\" , Text:\"\" , Flavour:\"Gnome Bard\" , Cost:[]}\n            ]\n        },\n        \"Warhammer\" : {\n            Durability:4,\n            SuitValue:\"2C\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Twin Daggers\" : {\n            Durability:3,\n            SuitValue:\"2H\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Simple Wand\" : {\n            Durability:4,\n            SuitValue:\"2S\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Lucky Coin\" : {\n            Durability:4,\n            SuitValue:\"2D\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Battle Axe\" : {\n            Durability:4,\n            SuitValue:\"3C\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Throwing Stars\" : {\n            Durability:4,\n            SuitValue:\"3H\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Crystal Orb\" : {\n            Durability:4,\n            SuitValue:\"3S\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Multi-Tool\" : {\n            Durability:4,\n            SuitValue:\"3D\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Iron Shield\" : {\n            Durability:4,\n            SuitValue:\"4C\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Leather Armour\" : {\n            Durability:4,\n            SuitValue:\"4H\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Ancient Map\" : {\n            Durability:4,\n            SuitValue:\"4S\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Traveler's Cloak\" : {\n            Durability:4,\n            SuitValue:\"4D\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Chainmail Armour\" : {\n            Durability:4,\n            SuitValue:\"5C\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Grappling Hook\" : {\n            Durability:4,\n            SuitValue:\"5H\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Mystic Hourglass\" : {\n            Durability:4,\n            SuitValue:\"5S\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Versatile Sword\" : {\n            Durability:4,\n            SuitValue:\"5D\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Spiked Gauntlets\" : {\n            Durability:4,\n            SuitValue:\"6C\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Climbing Rope\" : {\n            Durability:4,\n            SuitValue:\"6H\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Grimoire of Spells\" : {\n            Durability:4,\n            SuitValue:\"6S\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Healing Salve\" : {\n            Durability:4,\n            SuitValue:\"6D\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Greatsword\" : {\n            Durability:4,\n            SuitValue:\"7C\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Silent Boots\" : {\n            Durability:4,\n            SuitValue:\"7H\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Potion of Clarity\" : {\n            Durability:4,\n            SuitValue:\"7S\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Enchanted Lyre\" : {\n            Durability:4,\n            SuitValue:\"7D\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Reinforced Boots\" : {\n            Durability:4,\n            SuitValue:\"8C\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Lockpicks\" : {\n            Durability:4,\n            SuitValue:\"8H\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Mystic Amulet\" : {\n            Durability:4,\n            SuitValue:\"8S\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Rations\" : {\n            Durability:4,\n            SuitValue:\"8D\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Mighty Gauntlets\" : {\n            Durability:4,\n            SuitValue:\"9C\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Shortbow\" : {\n            Durability:4,\n            SuitValue:\"9H\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Runestone\" : {\n            Durability:4,\n            SuitValue:\"9S\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Bag of Tricks\" : {\n            Durability:4,\n            SuitValue:\"9D\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Heavy Crossbow\" : {\n            Durability:4,\n            SuitValue:\"10C\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Smoke Bombs\" : {\n            Durability:4,\n            SuitValue:\"10H\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Sage's Robes\" : {\n            Durability:4,\n            SuitValue:\"10S\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Portable Tent\" : {\n            Durability:4,\n            SuitValue:\"10D\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Dragonbone Mace\" : {\n            Durability:6,\n            SuitValue:\"JC\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Phantom Cloak\" : {\n            Durability:6,\n            SuitValue:\"JH\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Arcane Tome\" : {\n            Durability:6,\n            SuitValue:\"JS\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Ring of Adaptation\" : {\n            Durability:6,\n            SuitValue:\"JD\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Titan's Gauntlets\" : {\n            Durability:6,\n            SuitValue:\"QC\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Shadow Blade\" : {\n            Durability:6,\n            SuitValue:\"QH\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Archmage's Staff\" : {\n            Durability:6,\n            SuitValue:\"QS\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Chameleon Cloak\" : {\n            Durability:6,\n            SuitValue:\"QD\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"Ironclad Bruiser\" : {\n            Durability:8,\n            SuitValue:\"KC\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"The Elven Scout\" : {\n            Durability:8,\n            SuitValue:\"KH\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"The Wise Sage\" : {\n            Durability:8,\n            SuitValue:\"KS\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"The Mercenary\" : {\n            Durability:8,\n            SuitValue:\"KD\",\n            Footer:\"Item\",\n            Abilities:[\n                {Title:\"Damage 2\" , Text:\"Target player assigns 2 DC to a card in their field.\" , Flavour:\"\" , Cost:[\"Tap\"]}\n            ]\n        },\n        \"- Garran Stonefist -\" : {\n            Durability:18,\n            SuitValue:\"Jo\",\n            Footer:\"Character Placeholder\",\n            Abilities:[]\n        },\n        \"- Tessa Vale -\" : {\n            Durability:14,\n            SuitValue:\"Jo\",\n            Footer:\"Character Placeholder\",\n            Abilities:[]\n        },\n        \"- Victor Wren -\" : {\n            Durability:14,\n            SuitValue:\"Jo\",\n            Footer:\"Character Placeholder\",\n            Abilities:[]\n        },\n        \"- Rosie Goodwin -\" : {\n            Durability:16,\n            SuitValue:\"Jo\",\n            Footer:\"Character Placeholder\",\n            Abilities:[]\n        },\n        \"Help Card\" : {\n            Durability:0,\n            SuitValue:\"Jo\",\n            Footer:\"Help Card\",\n            Abilities:[],\n            HelpText:\"Setup for each player:\\n- Remove the 4 'Character' cards from your deck; place 1 in front of you (your Field) and set the rest aside. Your deck now has 48 'Item' and 'Ally' cards.\\n- Shuffle your deck and draw 5 cards from it. Players decide who goes first and turns proceed clockwise.\\n\\nDuring your Turn:\\n- Use abilities from cards in your field, most have costs. For what abilities look like and what their costs mean, see Help Card 2.\\n- If an abilities cost cannot be paid, the ability does not happen.\\n- Some cards have a durability value in the top-right of the card between its Name and Value-Suit (For use as standard playing cards).\\n\\nEnd of Turn:\\n- Any cards with no durability or Damage Counters (DC) at least equal to it, is destroyed.\\n- When a card is destroyed or discarded, it leaves your hand or field and moves next to it's owners Deck face-up (this is their Discard pile).\\n- Any player's with more than 5 cards in their hand has to discard cards from their hand until they have 5.\\n- Any player without a Character card in their field is out of the game and removes all cards they own from play.\\n- If you are the last remaining player, you win.\"\n        },\n        \"Help Card 2\" : {\n            Durability:0,\n            SuitValue:\"Jo\",\n            Footer:\"Help Card\",\n            Abilities:[\n                {Title:\"Slow\" , Text:\"After this ability fully resolves, your turn ends.\" , Flavour:\"\" , Cost:[\"Slow\"]},\n                {Title:\"Tap\" , Text:\"Tap a card by turning it sideways. You can't use the ability if it's already tapped. Untapping resets this.\" , Flavour:\"\" , Cost:[\"Tap\"]},\n                {Title:\"Power Point\" , Text:\"Consume 1 Power Point generated from other abilities. Power Points only last until the end of the current turn.\" , Flavour:\"\" , Cost:[\"Power\"]},\n                {Title:\"Agility Point\" , Text:\"Consume 1 Agility Point generated from other abilities. Agility Points only last until the end of the current turn.\" , Flavour:\"\" , Cost:[\"Agility\"]},\n                {Title:\"Wisdom Point\" , Text:\"Consume 1 Wisdom Point generated from other abilities. Wisdom Points only last until the end of the current turn.\" , Flavour:\"\" , Cost:[\"Wisdom\"]}\n            ]\n        }\n    }\n};\n\n\n//---------- C R E A T I O N ----------\n\n\nconst cardCnv = document.createElement('canvas');\nconst cardCtx = cardCnv.getContext('2d');\nconst icons = {\"Slow\":\"\" , \"Tap\":\"\" , \"Power\":\"\" , \"Agility\":\"\" , \"Wisdom\":\"\"};\n\n\n\nconst iconImage = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAQCAYAAACBSfjBAAAAAXNSR0IArs4c6QAAAORJREFUWIXtl+sOgyAMhWHZ+79y92cm2J1eaJkY0y8hIlIutT1ia0Wxk87uKWgn2aJ+j+IN2qxNa04ebYldV48fGcM7t9Tv5/nLuaAMfShZPBmi9fFmmBsUgdTsNzALgbrl0Ki8rLJ3wSPwmBRN5t04gts8RhtRCiMnZpzHx50Zg4YSIWPrskcpnMFabDbyroxcHkBwbkkD29eA1zV9lI42Xbla7HK4JmEneAoj5x3tmj5K8LSNpPFOzNODpIHSG5jduOTsv3wRF9OF+glJA1dFyEy63wm0PhhYK3/lEFkNLIpC5QPRVTgksfcGbAAAAABJRU5ErkJggg==\";\nsplitBase64Image(iconImage, Object.keys(icons).length);\n\n\n\n\n\n\n\nfunction drawCard(deck, cardTitle, x=0, y=0) {\n\n    cardCtx.fillStyle = \"black\";\n    cardCtx.fillRect(x, y, 512, 768);\n    cardCtx.fillStyle = \"white\";\n    cardCtx.fillRect(x+8, y+8, 512-16, 768-16);\n    const cardData = decks[deck][cardTitle];\n\n\n    if (cardData.Durability == 0) {\n        drawShape([{x:x , y:y+16} , {x:x+436 , y:y+16} , {x:x+436-48 , y:y+16+48} , {x:x , y:y+16+48}], 4); // <---- T I T L E   A R E A   ---- T E X T   A R E A ----> X+0 -> X+388\n        drawCenteredAndWrappedText(cardCtx, cardTitle, x+4, y+40, 388-8, \"bold 32px MyCustomFont\", \"black\", \"center\"); // <---- T I T L E   T E X T\n    } else {\n        drawShape([{x:x , y:y+16} , {x:x+342 , y:y+16} , {x:x+342-48 , y:y+16+48} , {x:x , y:y+16+48}], 4); // <---- T I T L E   A R E A   ---- T E X T   A R E A ----> X+0 -> X+294\n        drawShape([{x:x+436 , y:y+16} , {x:x+358 , y:y+16} , {x:x+358-48 , y:y+16+48} , {x:x+436-48 , y:y+16+48}], 4); // <---- D U R A B I L I T Y   A R E A   ---- T E X T   A R E A ----> X+358 -> X+388\n        drawCenteredAndWrappedText(cardCtx, cardTitle, x+4, y+40, 294-8, \"bold 32px MyCustomFont\", \"black\", \"center\"); // <---- T I T L E   T E X T\n        drawCenteredAndWrappedText(cardCtx, `${cardData.Durability}`, x+358, y+40, 30, \"bold 32px MyCustomFont\", \"black\", \"center\"); // <---- D U R A B I L I T Y   T E X T\n    }\n\n\n    drawShape([{x:x+512 , y:y+16} , {x:x+452 , y:y+16} , {x:x+452-48 , y:y+16+48} , {x:x+512 , y:y+16+48}], 4); // <---- S U I T   V A L U E   A R E A   ---- T E X T   A R E A ----> X+452 -> X+512\n    drawCenteredAndWrappedText(cardCtx, `${cardData.SuitValue}`, x+444, y+40, 60, \"bold 32px MyCustomFont\", \"black\", \"left\"); // <---- S U I T   V A L U E   T E X T\n\n    for (let i=0; i<cardData.Abilities.length; i++) {\n        const ability = cardData.Abilities[cardData.Abilities.length-1-i];\n        cardCtx.fillStyle = \"black\";\n        cardCtx.fillRect(x+24, y+768-24-96-(i*112)-24, 464, 96); // <---- A B I L I T Y   O U T E R   A R E A\n        cardCtx.fillStyle = \"white\";\n        cardCtx.fillRect(x+24+4, y+768-24-96-(i*112)+4-24, 464-8, 96-8); // <---- A B I L I T Y   I N N E R   A R E A\n\n        for (let j=0; j<ability.Cost.length; j++) {\n            drawCircle(x+40+(56*j) , y+768-24-96-(i*112)+16-24 , 24 , \"black\"); // <---- A B I L I T Y   C O S T   O U T E R   A R E A\n            drawCircle(x+40+(56*j) , y+768-24-96-(i*112)+16-24 , 20 , \"white\"); // <---- A B I L I T Y   C O S T   I N N E R   A R E A\n            cardCtx.imageSmoothingEnabled = false;\n            cardCtx.drawImage(icons[ability.Cost[j]], x+40+(56*j)-16 , y+768-24-96-(i*112)+16-16-24, 32, 32); // <---- D R A W   A B I L I T Y   I C O N\n        }\n        drawCenteredAndWrappedText(cardCtx, ability.Title, x+24+4+(ability.Cost.length*56), y+768-24-96-(i*112)+4+16-24, 512-56-(ability.Cost.length*56), \"bold 24px MyCustomFont\", \"black\", \"left\"); // <---- A B I L I T Y   T I T L E   T E X T\n\n        if (ability.Text != \"\") drawCenteredAndWrappedText(cardCtx, ability.Text, x+24+4+4, y+768-24-96-(i*112)+66-24, 512-64, \"16px MyCustomFont\", \"black\", \"left\"); // <---- A B I L I T Y   T E X T\n        if (ability.Flavour != \"\") drawCenteredAndWrappedText(cardCtx, ability.Flavour, x+24+4+4, y+768-24-96-(i*112)+44-24, 512-64, \"italic bold 16px MyCustomFont\", \"black\", \"center\"); // <---- A B I L I T Y   F L A V O U R   T E X T\n    }\n    drawShape([{x:x , y:y+768} , {x:x+32 , y:y+768-32} , {x:x+512-32 , y:y+768-32} , {x:x+512 , y:y+768}], 4); // <---- D R A W   C L A S S   A R E A\n    drawCenteredAndWrappedText(cardCtx, cardData.Footer, x+32, y+768-20, 512-64, \"16px MyCustomFont\", \"black\", \"center\"); // <---- C L A S S   T E X T\n\n    if (\"HelpText\" in cardData) drawCenteredAndWrappedText(cardCtx, cardData.HelpText, x+12, y+400, 512-24, \"bold 19px MyCustomFont\", \"black\", \"left\"); // <---- H E L P   T E X T\n}\n\n\n\n\n\n\n\n\n\nfunction splitBase64Image(base64String, numOfImages) {\n    var img = new Image();\n    img.onload = function() {\n        var tempCnv = document.createElement('canvas');\n        var tempCtx = tempCnv.getContext('2d');\n        tempCnv.width = img.width;\n        tempCnv.height = img.height;\n        tempCtx.drawImage(img, 0, 0);\n\n        var subWidth = Math.floor(img.width / numOfImages);\n        var loadedCount = 0;\n\n        for (let i = 0; i < numOfImages; i++) {\n            var subCnv = document.createElement('canvas');\n            var subCtx = subCnv.getContext('2d');\n            subCnv.width = subWidth;\n            subCnv.height = img.height;\n\n            subCtx.drawImage(tempCnv, \n                             i * subWidth, 0, \n                             subWidth, img.height, \n                             0, 0, \n                             subWidth, img.height);\n\n            var subImage = new Image();\n            subImage.onload = function() {\n                loadedCount++;\n                if (loadedCount === numOfImages) {\n                    downloadCardsFromDeck();\n                }\n            };\n            subImage.src = subCnv.toDataURL('image/png');\n            icons[Object.keys(icons)[i]] = subImage;\n        }\n    };\n    img.src = base64String;\n}\n\n\n\nfunction downloadCardsFromDeck() {\n    cardCtx.clearRect(0, 0, cardCnv.width, cardCnv.height);\n    let snapTrack = 0;\n    let yTrack = 0;\n    let xTrack = 0;\n    cardCnv.width = xCoord*512;\n    cardCnv.height = yCoord*768;\n\n    for (const cardTitle in decks[deckToDownload]) {\n        drawCard(deckToDownload , cardTitle , xTrack*512 , yTrack*768);\n        if (xTrack < (xCoord-1)) {\n            xTrack += 1;\n        } else {\n            xTrack = 0;\n            if (yTrack < (yCoord-1)) {\n                yTrack += 1;\n            } else {\n                snapCanvas(`Cards_${snapTrack}`);\n                snapTrack += 1;\n                cardCtx.clearRect(0, 0, cardCnv.width, cardCnv.height);\n                yTrack = 0;\n            }\n        } \n    }\n    if (!(xTrack == 0 && yTrack == 0)) {\n        snapCanvas(`Cards_${snapTrack}`);\n        cardCtx.clearRect(0, 0, cardCnv.width, cardCnv.height);\n    }\n    ToolKit();\n}\n\n\n\n\nfunction snapCanvas(name) {\n    cardCtx.imageSmoothingEnabled = false;\n    let cardCnvImage = cardCnv.toDataURL(\"image/png\", 1.0);\n    let link = document.createElement('a');\n    link.download = `${name}.png`;\n    link.href = cardCnvImage;\n    document.body.appendChild(link);\n    link.click();\n    document.body.removeChild(link);\n}\n\n\n\nfunction drawCircle(centerX , centerY , radius , colour) {\n    cardCtx.beginPath();\n    cardCtx.arc(centerX, centerY, radius, 0, 2 * Math.PI);\n    cardCtx.fillStyle = colour;\n    cardCtx.fill();\n}\n\n\n\nfunction drawShape(locations, width) {\n    cardCtx.beginPath();\n    cardCtx.moveTo(locations[0].x, locations[0].y);\n    for (let i=1; i<locations.length; i++) {\n        cardCtx.lineTo(locations[i].x, locations[i].y);\n    }\n    cardCtx.closePath();\n    cardCtx.lineWidth = width;\n    cardCtx.strokeStyle = \"black\";\n    cardCtx.stroke();\n}\n\nfunction drawCenteredAndWrappedText(canvasCtx, text, x, y, maxWidth, font, textStyle, align) {\n    canvasCtx.fillStyle = textStyle;\n    let xCoord = (align == \"left\") ? x : x + (maxWidth / 2);\n    canvasCtx.font = font;\n    let fontSize = parseInt(font.match(/\\d+px/)[0]);\n    let lineHeight = fontSize * 1.2;\n    canvasCtx.textAlign = align;\n    canvasCtx.textBaseline = \"middle\";\n\n    // Split the text by \\n and keep track of empty lines for multiple newlines\n    let parts = text.split('\\n');\n    let lines = [];\n    \n    for (let part of parts) {\n        let words = part.split(' ');\n        let currentLine = '';\n\n        for (let word of words) {\n            let testLine = currentLine + word + ' ';\n            let metrics = canvasCtx.measureText(testLine);\n            \n            if (metrics.width > maxWidth) {\n                if (currentLine) lines.push(currentLine.trim());\n                currentLine = word + ' ';\n            } else {\n                currentLine = testLine;\n            }\n        }\n        \n        if (currentLine.trim().length > 0) lines.push(currentLine.trim());\n        // If there's an empty part (i.e., \\n\\n), just push a blank line\n        if (part === '') lines.push('');\n    }\n\n    // Calculate total height including any extra space for blank lines (multiple \\n)\n    let totalHeight = lines.length * lineHeight;\n    let startY = y - totalHeight / 2 + lineHeight / 2;\n    \n    lines.forEach((line, index) => {\n        // If the line is empty (for consecutive \\n), add more vertical space\n        let yOffset = line === '' ? lineHeight * 1.5 : lineHeight; // Increase the gap for blank lines\n        canvasCtx.fillText(line, xCoord, startY + index * yOffset);\n    });\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","//Ability Ideas\n\n\n/*\n\n\n\nSetup for each player:\\nRemove the 4 'Character' cards from your deck; place 1 in front of you (your Field) and set the rest aside. Your deck now has 48 'Item' and 'Ally' cards.\\nShuffle your deck and draw 5 cards from it. Players decide who goes first and turns proceed clockwise.\\n\\nDuring your Turn:\\nUse abilities from cards in your field, most have costs. For what abilities look like and what their costs mean, see Help Card 2. If an abilities cost cannot be paid, the ability does not happen.\\nSome cards have a durability value in the top-right of the card between its Name and Value-Suit (For use as standard playing cards). When a card is destroyed or discarded, it leaves your hand or field and moves next to it's owners Deck face-up (this is their Discard pile).\\n\\nEnd of Turn:\\nAny cards with no durability or Damage Counters (DC) at least equal to it, is destroyed.\\nAny player's with more than 5 cards in their hand has to discard cards from their hand until they have 5.\\nAny player without a Character card in their field is out of the game and removes all cards they own from play.\\nIf you are the last remaining player, you win.\n\n\n- Strike X (Slow, Tap) : Target player assigns X DC to a card in their field.\n\n- Search X (Slow, Tap) : Draw X cards from your deck.\n\n- Crushing Blow X (Slow, Tap) : Target Item with at least 1 DC gains X more.\n\n- Cleave X (Slow, Tap) : Target player assigns 1 DC to a card in their field X times.\n\n- Rage X (Tap) : Gain X Power Points.\n\n- Focus X (Tap) : Gain X Agility Points.\n\n- Study X (Tap) : Gain X Wisdom Points.\n\n- Summon X (Tap) : Play 1 Ally card from your hand into your field.\n\n- Heal X (Tap, Slow) : Remove X DC from target Ally or Character.\n\n- Repair X (Tap, Slow) : Remove X DC from target Item.\n\n- Insight X (Tap) : Look at the top X cards from your deck, put them back in any order.\n\n- Lucky Find X (Tap, Slow) : Draw X cards from your deck, discard (X-1) cards from your hand.\n\n- Precise Strike X (Tap, Slow) : Target card gains X DC.\n\n- Shockwave (Tap, Slow, Power, Power) : Tap all Item cards in target players field.\n\n- Revive (Tap, Slow) : Return a card from your discard pile back to your hand.\n\n- Reanimate (Tap, Wisdom, Wisdom) : Move a card from your discard pile to your field.\n\n- Swap (Agility) : Play a card from your hand into your field, return this card to your hand.\n\n- Stealth : Ally and Character abilities cannot target this card.\n\n- Reflex X : If a card's ability targets this, that card gains X DC.\n\n\n\n\n\n\n\n*/\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","//Page 2\n"],"PasswordManager":["//Password Manager","//Page 1\n"]};
        let persistent = {"files":{},"icons":{"Export":{"7x1":32,"8x1":32,"6x2":32,"7x2":19,"8x2":19,"9x2":32,"5x3":32,"6x3":19,"7x3":19,"8x3":19,"9x3":19,"10x3":32,"4x4":32,"5x4":19,"6x4":19,"9x4":19,"10x4":19,"11x4":32,"4x5":32,"5x5":32,"6x5":32,"7x5":19,"8x5":19,"9x5":32,"10x5":32,"11x5":32,"7x6":19,"7x7":19,"7x8":19,"7x9":19,"7x10":19,"7x11":19,"7x12":19,"7x13":19,"7x14":32,"8x14":32,"8x13":19,"8x12":19,"8x11":19,"8x10":19,"8x9":19,"8x8":19,"8x7":19,"8x6":19,"7x4":19,"8x4":19,"6x6":32,"6x7":32,"6x8":32,"6x9":32,"6x10":32,"6x11":32,"6x12":32,"6x13":32,"6x14":32,"9x14":32,"9x13":32,"9x12":32,"9x11":32,"9x10":32,"9x9":32,"9x8":32,"9x7":32,"9x6":32},"Import":{"6x10":32,"6x11":19,"6x12":19,"6x13":32,"7x14":32,"7x13":19,"7x12":19,"7x11":19,"7x10":19,"7x9":19,"7x8":19,"7x7":19,"7x6":19,"7x5":19,"7x4":19,"7x3":19,"7x2":19,"7x1":32,"5x12":32,"5x11":19,"4x11":32,"4x10":32,"5x10":32,"8x10":19,"9x10":32,"10x10":32,"11x10":32,"10x11":19,"9x11":19,"8x11":19,"8x12":19,"9x12":19,"8x13":19,"8x14":32,"9x13":32,"10x12":32,"11x11":32,"8x1":32,"8x2":19,"8x3":19,"8x4":19,"8x9":19,"8x8":19,"8x7":19,"8x6":19,"8x5":19,"6x9":32,"6x8":32,"6x7":32,"6x6":32,"6x5":32,"6x4":32,"6x3":32,"6x2":32,"6x1":32,"9x1":32,"9x2":32,"9x3":32,"9x4":32,"9x5":32,"9x6":32,"9x7":32,"9x8":32,"9x9":32},"ToolKit":{"2x13":10,"3x13":10,"4x13":10,"5x13":10,"6x13":10,"7x13":10,"8x13":10,"9x13":10,"10x13":10,"11x13":10,"12x13":10,"13x13":10,"13x12":10,"13x11":10,"12x11":11,"11x11":11,"10x11":11,"9x11":11,"8x11":11,"7x11":11,"6x11":11,"5x11":11,"4x11":11,"3x11":11,"3x10":11,"2x10":11,"2x9":11,"3x9":11,"4x9":11,"5x9":11,"6x9":11,"7x9":11,"8x9":11,"9x9":11,"10x9":11,"11x9":11,"12x9":11,"13x9":10,"13x10":10,"12x10":11,"11x10":11,"10x10":11,"9x10":11,"8x10":11,"7x10":11,"6x10":11,"5x10":11,"4x10":11,"2x11":11,"2x12":11,"3x12":11,"4x12":11,"5x12":11,"6x12":11,"7x12":11,"8x12":11,"9x12":11,"10x12":11,"11x12":11,"12x12":11,"4x8":21,"4x7":21,"4x6":21,"5x6":21,"6x6":21,"7x6":21,"8x6":21,"9x6":21,"10x6":21,"11x6":21,"11x7":21,"11x8":21,"1x9":32,"1x10":32,"1x11":32,"1x12":32,"1x13":32,"3x14":32,"4x14":32,"5x14":32,"6x14":32,"7x14":32,"8x14":32,"9x14":32,"10x14":32,"11x14":32,"12x14":32,"13x14":32,"14x14":32,"14x13":32,"14x12":32,"14x11":32,"14x10":32,"14x9":32,"14x8":32,"13x8":32,"12x8":32,"12x7":32,"12x6":32,"11x5":32,"10x5":32,"9x5":32,"8x5":32,"7x5":32,"6x5":32,"5x5":32,"4x5":32,"3x6":32,"3x7":32,"3x8":32,"2x8":32,"1x8":32,"5x8":32,"6x8":32,"7x8":32,"8x8":32,"9x8":32,"10x8":32,"1x14":32,"2x14":32},"Help":{"7x14":19,"8x14":19,"8x13":19,"7x13":19,"7x11":19,"7x10":19,"8x11":19,"8x10":19,"8x9":19,"7x9":19,"4x4":19,"3x4":19,"3x3":19,"4x3":19,"4x2":19,"5x2":19,"5x3":19,"5x1":19,"6x1":19,"6x2":19,"7x1":19,"8x1":19,"9x1":19,"7x2":19,"8x2":19,"9x2":19,"10x3":19,"10x2":19,"10x1":19,"11x2":19,"11x3":19,"11x4":19,"12x4":19,"12x3":19,"11x5":19,"12x5":19,"11x6":19,"12x6":19,"8x8":19,"9x8":19,"9x9":19,"9x7":19,"10x7":19,"10x8":19,"11x7":19,"10x6":19,"2x3":32,"2x4":32,"3x5":32,"4x5":32,"5x4":32,"6x3":32,"7x3":32,"8x3":32,"9x3":32,"10x4":32,"10x5":32,"9x6":32,"8x7":32,"7x8":32,"6x9":32,"6x10":32,"6x11":32,"7x12":32,"8x12":32,"9x13":32,"9x14":32,"8x15":32,"7x15":32,"6x13":32,"6x14":32,"9x11":32,"9x10":32,"10x9":32,"11x8":32,"12x7":32,"13x6":32,"13x5":32,"13x4":32,"13x3":32,"12x2":32,"11x1":32,"10x0":32,"9x0":32,"8x0":32,"7x0":32,"6x0":32,"5x0":32,"4x1":32,"3x2":32},"Reset":{"4x10":32,"5x13":32,"12x11":32,"12x10":32,"12x9":32,"12x8":32,"12x7":32,"12x12":32,"11x13":32,"10x13":32,"9x13":32,"8x13":32,"7x13":32,"6x13":32,"6x11":32,"7x11":32,"8x11":32,"9x11":32,"10x11":32,"11x10":32,"6x8":32,"7x8":32,"8x8":32,"9x8":32,"10x8":32,"11x7":32,"12x6":32,"4x5":32,"5x5":32,"6x5":32,"7x5":32,"8x5":32,"9x5":32,"10x5":32,"11x5":32,"12x4":32,"13x3":32,"12x2":32,"4x2":32,"5x2":32,"11x2":32,"12x5":32,"7x3":32,"7x1":32,"8x1":32,"9x1":32,"8x3":32,"9x3":32,"10x2":32,"3x4":32,"3x5":32,"3x6":32,"3x7":32,"3x8":32,"3x9":32,"3x10":32,"3x11":32,"3x12":32,"4x13":32,"5x11":32,"4x7":32,"5x8":32,"2x3":32,"3x2":32,"6x3":32,"6x1":32,"4x11":21,"4x12":21,"5x12":21,"6x12":21,"7x12":21,"8x12":22,"9x12":22,"10x12":22,"11x12":22,"11x11":22,"11x8":22,"11x9":22,"10x9":22,"9x9":21,"8x9":21,"7x9":21,"6x9":21,"5x9":21,"4x9":21,"4x8":21,"5x10":21,"6x10":21,"9x10":22,"10x10":22,"8x10":21,"7x10":21,"4x6":21,"5x6":21,"6x6":21,"7x6":21,"8x6":21,"9x6":21,"10x6":21,"11x6":22,"10x7":22,"8x7":21,"7x7":21,"6x7":21,"5x7":21,"9x7":21,"3x3":21,"4x3":21,"5x3":21,"5x4":21,"6x4":21,"7x4":21,"8x4":21,"9x4":21,"10x4":21,"11x4":21,"11x3":21,"10x3":22,"12x3":21,"4x4":21,"6x2":21,"7x2":21,"8x2":21,"9x2":21},"Fullscreen":{"1x11":32,"2x11":32,"3x11":32,"4x11":32,"5x11":32,"6x11":32,"7x11":32,"8x11":32,"9x11":32,"10x11":32,"11x11":32,"12x11":32,"13x11":32,"14x11":32,"14x10":32,"14x9":32,"14x8":32,"14x7":32,"14x6":32,"14x5":32,"14x4":32,"14x3":32,"1x3":32,"1x4":32,"1x5":32,"1x6":32,"1x7":32,"1x8":32,"1x9":32,"1x10":32,"7x12":22,"9x12":32,"6x13":22,"5x13":22,"4x13":32,"5x14":32,"6x14":32,"7x14":32,"8x14":32,"9x14":32,"10x14":32,"10x13":22,"11x13":32,"2x3":20,"2x4":20,"2x5":20,"2x6":20,"2x7":20,"3x3":20,"4x3":20,"5x3":20,"6x3":20,"7x3":20,"8x3":20,"9x3":20,"10x3":20,"11x3":20,"12x3":20,"13x3":20,"13x4":20,"13x5":20,"13x6":20,"13x7":20,"13x8":20,"2x10":20,"3x10":20,"4x10":20,"5x10":20,"6x10":20,"7x10":20,"8x10":20,"9x10":20,"10x10":20,"11x10":20,"12x10":20,"13x10":20,"13x9":20,"2x8":20,"2x9":20,"3x9":19,"4x9":19,"5x9":19,"6x9":19,"7x9":19,"8x9":19,"9x9":19,"10x9":19,"11x9":19,"12x9":19,"12x8":19,"12x7":19,"11x7":19,"10x7":19,"10x8":19,"9x8":19,"8x8":19,"7x8":19,"6x8":19,"5x8":19,"4x8":19,"3x8":19,"11x8":19,"9x7":19,"8x7":19,"7x7":19,"6x7":19,"5x7":19,"4x7":19,"3x7":19,"3x6":19,"4x6":19,"5x6":19,"6x6":19,"7x6":19,"8x6":19,"9x6":19,"10x6":19,"11x6":19,"12x6":19,"12x5":19,"11x5":19,"10x5":19,"9x5":19,"8x5":19,"7x5":19,"6x5":19,"5x5":19,"4x5":19,"3x5":19,"3x4":19,"4x4":19,"5x4":19,"6x4":19,"7x4":19,"8x4":19,"9x4":19,"10x4":19,"11x4":19,"12x4":19,"7x13":22,"8x13":22,"9x13":22,"8x12":22,"4x1":32,"5x1":32,"6x1":32,"7x1":32,"8x1":32,"9x1":32,"10x1":32,"11x1":32,"12x1":32,"3x1":32,"6x12":32,"3x2":21,"4x2":21,"5x2":21,"6x2":21,"7x2":21,"8x2":21,"9x2":21,"10x2":21,"11x2":21,"12x2":21,"2x2":32,"13x2":32,"5x12":32,"10x12":32},"GameEngine":{"7x0":32,"8x0":32,"5x1":32,"6x1":32,"4x2":32,"3x2":32,"2x3":32,"1x3":32,"0x4":32,"9x1":32,"10x1":32,"11x2":32,"12x2":32,"13x3":32,"14x3":32,"15x4":32,"14x5":32,"13x5":32,"12x6":32,"11x6":32,"10x7":32,"9x7":32,"8x8":32,"7x8":32,"6x7":32,"5x7":32,"4x6":32,"3x6":32,"2x5":32,"1x5":32,"0x5":32,"0x6":32,"0x7":32,"0x8":32,"0x9":32,"0x10":32,"7x9":32,"7x10":32,"7x11":32,"7x12":32,"7x13":32,"8x13":32,"8x14":32,"8x15":32,"7x15":32,"7x14":32,"8x12":32,"8x11":32,"8x10":32,"8x9":32,"6x14":32,"5x14":32,"4x13":32,"3x13":32,"2x12":32,"1x12":32,"0x11":32,"9x14":32,"10x14":32,"11x13":32,"12x13":32,"13x12":32,"14x12":32,"15x11":32,"15x10":32,"15x9":32,"15x8":32,"15x7":32,"15x6":32,"15x5":32,"1x10":5,"1x11":5,"2x11":5,"3x11":5,"3x12":5,"4x12":5,"5x12":5,"5x13":5,"6x13":5,"6x12":5,"6x11":5,"5x11":4,"4x11":5,"4x10":5,"3x10":4,"3x9":5,"2x9":5,"2x10":5,"1x9":4,"1x8":5,"9x13":5,"10x13":5,"10x12":5,"9x12":5,"9x11":5,"10x11":4,"11x11":5,"12x11":5,"12x10":4,"12x9":5,"13x9":5,"13x8":4,"14x8":5,"14x9":4,"14x10":5,"14x11":5,"13x11":5,"13x10":5,"12x12":5,"11x12":5,"1x4":13,"2x4":13,"3x4":13,"4x4":12,"5x4":13,"6x4":13,"7x4":13,"8x4":13,"9x4":13,"10x4":12,"11x4":13,"12x4":13,"13x4":13,"14x4":13,"12x3":13,"11x3":13,"10x3":13,"9x3":13,"8x3":13,"7x3":12,"6x3":13,"5x3":13,"4x3":13,"3x3":13,"5x2":13,"6x2":13,"7x2":12,"8x2":12,"9x2":13,"10x2":13,"8x1":13,"7x1":13,"3x5":13,"4x5":13,"5x5":13,"6x5":12,"7x5":12,"8x5":13,"9x5":13,"10x5":13,"11x5":13,"12x5":13,"10x6":13,"9x6":13,"8x6":13,"7x6":12,"6x6":13,"5x6":13,"7x7":13,"8x7":13,"1x6":4,"1x7":4,"2x7":4,"3x7":4,"3x8":5,"4x8":4,"4x9":4,"5x9":5,"5x10":5,"6x10":4,"6x9":4,"6x8":4,"5x8":4,"4x7":4,"2x6":4,"2x8":4,"9x10":4,"9x9":4,"9x8":4,"10x8":4,"10x9":5,"11x9":4,"11x10":5,"11x8":4,"11x7":4,"12x7":4,"13x7":4,"14x7":4,"14x6":4,"13x6":4,"12x8":5,"10x10":5,"0x3":19,"0x2":19,"0x1":19,"0x0":19,"1x0":19,"2x0":19,"3x0":19,"4x0":19,"5x0":19,"6x0":19,"4x1":19,"3x1":19,"2x1":19,"1x1":19,"1x2":19,"2x2":19,"9x0":19,"10x0":19,"11x0":19,"12x0":19,"13x0":19,"14x0":19,"15x0":19,"15x1":19,"15x2":19,"15x3":19,"14x2":19,"13x2":19,"14x1":19,"13x1":19,"12x1":19,"11x1":19,"0x12":19,"0x13":19,"0x14":19,"0x15":19,"1x15":19,"2x15":19,"3x15":19,"4x15":19,"5x15":19,"6x15":19,"4x14":19,"3x14":19,"2x14":19,"1x14":19,"2x13":19,"1x13":19,"9x15":19,"10x15":19,"11x15":19,"12x15":19,"13x15":19,"14x15":19,"15x15":19,"15x14":19,"14x14":19,"13x14":19,"12x14":19,"11x14":19,"13x13":19,"14x13":19,"15x13":19,"15x12":19},"CardCreator":{"4x1":32,"5x1":32,"6x1":32,"7x1":32,"8x1":32,"9x1":32,"10x1":32,"11x1":32,"12x1":32,"3x1":32,"3x2":32,"3x3":32,"3x4":32,"3x5":32,"3x6":32,"3x7":32,"3x8":32,"3x9":32,"3x10":32,"3x11":32,"3x12":32,"3x13":32,"3x14":32,"4x14":32,"5x14":32,"6x14":32,"7x14":32,"8x14":32,"9x14":32,"10x14":32,"11x14":32,"12x14":32,"12x13":32,"12x12":32,"12x11":32,"12x10":32,"12x9":32,"12x8":32,"12x7":32,"12x6":32,"12x5":32,"12x4":32,"12x3":32,"12x2":32,"4x2":19,"5x2":19,"6x2":19,"7x2":19,"8x2":19,"9x2":19,"10x2":19,"11x2":19,"11x3":19,"10x3":25,"9x3":25,"8x3":25,"7x3":25,"6x3":25,"5x3":25,"4x3":19,"4x4":19,"5x4":19,"6x4":19,"7x4":19,"8x4":19,"9x4":19,"10x4":19,"11x4":19,"11x5":19,"10x5":32,"9x5":32,"8x5":32,"7x5":32,"6x5":32,"5x5":32,"4x5":19,"4x6":19,"5x6":32,"6x6":17,"7x6":5,"8x6":17,"9x6":5,"10x6":32,"11x6":19,"11x7":19,"10x7":32,"9x7":13,"8x7":13,"7x7":13,"6x7":13,"5x7":32,"4x7":19,"4x8":19,"5x8":32,"6x8":32,"7x8":32,"8x8":32,"9x8":32,"10x8":32,"11x8":19,"11x9":19,"10x9":19,"9x9":19,"8x9":19,"7x9":19,"6x9":19,"5x9":19,"4x9":19,"4x10":19,"5x10":25,"6x10":25,"7x10":25,"8x10":25,"9x10":25,"10x10":25,"11x10":19,"11x11":19,"10x11":19,"9x11":19,"8x11":19,"7x11":19,"6x11":19,"5x11":19,"4x11":19,"4x12":19,"5x12":25,"6x12":25,"7x12":25,"8x12":25,"9x13":19,"10x13":19,"10x12":25,"11x12":19,"11x13":19,"8x13":19,"7x13":19,"6x13":19,"5x13":19,"4x13":19,"9x12":25},"PasswordManager":{"3x8":32,"3x9":32,"3x10":32,"3x11":32,"3x12":32,"3x13":32,"4x13":32,"5x13":32,"6x13":32,"7x13":32,"8x13":32,"9x13":32,"10x13":32,"11x13":32,"12x13":32,"12x12":32,"12x11":32,"12x10":32,"12x9":32,"12x8":32,"12x7":32,"11x7":32,"10x7":32,"9x7":32,"8x7":32,"7x7":32,"6x7":32,"5x7":32,"4x7":32,"3x7":32,"4x6":32,"4x5":32,"5x4":32,"6x3":32,"7x3":32,"11x6":32,"11x5":32,"10x4":32,"9x3":32,"8x3":32,"5x6":32,"5x5":32,"6x4":32,"7x4":32,"8x4":32,"9x4":32,"10x5":32,"10x6":32,"9x5":32,"6x5":32,"4x8":23,"4x9":23,"4x10":23,"4x11":23,"4x12":23,"5x12":23,"6x12":23,"7x12":23,"8x12":23,"9x12":23,"10x12":23,"11x12":23,"11x11":23,"11x10":23,"11x9":23,"11x8":23,"8x8":23,"7x8":23,"6x8":23,"5x8":23,"9x8":23,"10x8":23,"5x9":23,"5x10":23,"5x11":23,"6x11":23,"6x10":23,"6x9":23,"7x9":23,"7x10":23,"7x11":23,"8x11":23,"9x11":19,"10x11":19,"10x10":19,"10x9":19,"9x9":19,"8x9":23,"8x10":23,"9x10":19}}};
        let Mark2;

        window.initFunc = "ToolKit";

        window.db;

        window.openDB = function() {
            return new Promise((resolve, reject) => {
                const request = indexedDB.open("myDataDB", 1);
                request.onerror = () => reject(request.error);
                request.onsuccess = () => {
                    window.db = request.result;
                    resolve();
                };
                request.onupgradeneeded = (event) => {
                    window.db = event.target.result;
                    window.db.createObjectStore("data", { keyPath: "id" });
                };
            });
        }

        
        window.saveData = function() {
            return window.openDB().then(() => {
                const transaction = window.db.transaction(["data"], "readwrite");
                const objectStore = transaction.objectStore("data");
                const request = objectStore.put({
                    id: "allData",
                    functions: JSON.stringify(functions),
                    persistent: JSON.stringify(persistent)
                });
                return new Promise((resolve, reject) => {
                    request.onsuccess = () => resolve();
                    request.onerror = () => reject(request.error);
                });
            });
        }

        window.loadData = function() {
            return window.openDB().then(() => {
                const transaction = window.db.transaction(["data"], "readonly");
                const objectStore = transaction.objectStore("data");
                const request = objectStore.get("allData");
                return new Promise((resolve, reject) => {
                    request.onsuccess = () => {
                        if (request.result) {
                            functions = JSON.parse(request.result.functions);
                            persistent = JSON.parse(request.result.persistent);
                            resolve({
                                functions: true,
                                persistent: true
                            });
                        } else {
                            resolve({ functions: null, persistent: null });
                        }
                    };
                    request.onerror = () => reject(request.error);
                });
            });
        }

        window.reset = function() {
            return new Promise((resolve, reject) => {
                const request = indexedDB.deleteDatabase("myDataDB");
                request.onerror = () => reject(request.error);
                request.onsuccess = () => resolve();
            });
        }        

        window.loadData().then(data => {
            if (data.functions === null || data.persistent === null) {
                console.log("No data found or data not yet saved so using default.");
                window.saveData();
            }
            createScriptTags();
            window[window.initFunc]();
            
        });

        function createScriptTags() {
            for (const funcName in functions) {
                if (document.getElementById(`${funcName}Script`)) document.getElementById(`${funcName}Script`).remove();
                let funcText = "";
                for (let i=0; i<functions[funcName].length; i++) {
                    funcText += functions[funcName][i] + "\n";
                } 
                let scriptTag = document.createElement('script');
                scriptTag.innerHTML = `async function ${funcName}(arg) {
                    ${funcText}
                };`;
                scriptTag.id = `${funcName}Script`;
                document.body.appendChild(scriptTag);
            }
        }

        function updateScriptTag(funcName) {
            if (document.getElementById(`${funcName}Script`)) document.getElementById(`${funcName}Script`).remove();
            let funcText = "";
            for (let i=0; i<functions[funcName].length; i++) {
                funcText += functions[funcName][i] + "\n";
            } 
            let scriptTag = document.createElement('script');
            scriptTag.innerHTML = `async function ${funcName}(arg) {
                ${funcText}
            };`;
            scriptTag.id = `${funcName}Script`;
            document.body.appendChild(scriptTag);
        }

    </script>
  
</body></html>
